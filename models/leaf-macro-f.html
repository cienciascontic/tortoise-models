



<html>
  <head>
<link rel="stylesheet" type="text/css" href="app.css" charset="utf-8"/>
<link rel="stylesheet" type="text/css" href="app-custom.css" charset="utf-8"/>
  </head>
  <body>
    <div id="model-container"></div>
<script type="text/javascript" src="app.js"></script>
    <script type="text/javascript">
;

      var session =
        (function () {
          var widgets = "[{\"left\":137,\"top\":14,\"right\":475,\"bottom\":373,\"patchSize\":8.0,\"fontSize\":10,\"wrappingAllowedInX\":true,\"wrappingAllowedInY\":true,\"minPxcor\":-20,\"maxPxcor\":20,\"minPycor\":-20,\"maxPycor\":20,\"updateMode\":\"TickBased\",\"showTickCounter\":true,\"tickCounterLabel\":\"ticks\",\"frameRate\":30.0,\"type\":\"view\"},\n{\"compiledSource\":{\"success\":true,\"result\":\"Call(procedures.setup);\"},\"display\":\"Setup/Reset\",\"left\":9,\"top\":15,\"right\":115,\"bottom\":48,\"source\":\"setup\",\"forever\":false,\"buttonType\":\"OBSERVER\",\"actionKey\":null,\"type\":\"button\"},\n{\"compiledSource\":{\"success\":true,\"result\":\"Call(procedures.go);\"},\"display\":\"Run/Stop\",\"left\":25,\"top\":62,\"right\":103,\"bottom\":95,\"source\":\"go\",\"forever\":true,\"buttonType\":\"OBSERVER\",\"actionKey\":null,\"type\":\"button\"},\n{\"getStep\":function() { return 1; },\"getMin\":function() { return 0; },\"getMax\":function() { return 20; },\"compiledMin\":{\"success\":true,\"result\":\"0\"},\"compiledMax\":{\"success\":true,\"result\":\"20\"},\"compiledStep\":{\"success\":true,\"result\":\"1\"},\"display\":\"water-flow\",\"left\":17,\"top\":223,\"right\":130,\"bottom\":256,\"varName\":\"water-flow\",\"min\":\"0\",\"max\":\"20\",\"default\":10.0,\"step\":\"1\",\"direction\":\"horizontal\",\"type\":\"slider\"},\n{\"getStep\":function() { return 1; },\"getMin\":function() { return 0; },\"getMax\":function() { return 30; },\"compiledMin\":{\"success\":true,\"result\":\"0\"},\"compiledMax\":{\"success\":true,\"result\":\"30\"},\"compiledStep\":{\"success\":true,\"result\":\"1\"},\"display\":\"CO2-amount\",\"left\":13,\"top\":179,\"right\":129,\"bottom\":212,\"varName\":\"CO2-amount\",\"min\":\"0\",\"max\":\"30\",\"default\":14.0,\"step\":\"1\",\"direction\":\"horizontal\",\"type\":\"slider\"},\n{\"getStep\":function() { return 1; },\"getMin\":function() { return 0; },\"getMax\":function() { return 100; },\"compiledMin\":{\"success\":true,\"result\":\"0\"},\"compiledMax\":{\"success\":true,\"result\":\"100\"},\"compiledStep\":{\"success\":true,\"result\":\"1\"},\"display\":\"sun-brightness\",\"left\":14,\"top\":134,\"right\":133,\"bottom\":167,\"varName\":\"sun-brightness\",\"min\":\"0\",\"max\":\"100\",\"default\":36.0,\"step\":\"1\",\"direction\":\"horizontal\",\"type\":\"slider\"},\n{\"display\":\"day-night?\",\"left\":17,\"top\":298,\"right\":126,\"bottom\":331,\"varName\":\"day-night?\",\"on\":false,\"type\":\"switch\"},\n{\"display\":\"Turns on the day-night cycle\",\"left\":27,\"top\":337,\"right\":139,\"bottom\":365,\"fontSize\":11,\"color\":0.0,\"transparent\":true,\"type\":\"textBox\"}]";
          var code    = "globals [ sugarcount sugarcount-old sugar-rate oxygencount O2-temp-count \n          vapor-temp-count\n          sugar-temp-count step time-unit  day?\n          sugarsmoothed sugarsmoothed-old sugar-rate-smoothed \n          smoothness smoothness-2 percent-excited]\n          \nturtles-own [ water-in-leaf?   ]\npatches-own [     ]\nbreed [light  ]\nbreed [sun]\nbreed [sugar]\nsun-own [   old-xcor ]\nbreed [ CO2 ]\nbreed [ oxygen ]\nbreed [ water ]\nbreed [vapor]\nbreed [ chloroplast ]\nchloroplast-own [ NADPH? ]\n\nto startup\nsetup\nend\n\nto setup\nclear-all\nmy-import-drawing \"aspenleaftrans.png\"\ncreateplant\ncreatesun\ncreatechloroplast\nask water [ set water-in-leaf? false]\nset day? true\nset sun-brightness 36\nset co2-amount 14\nset water-flow 10\nreset-ticks\nend\n\nto my-import-drawing [src]\nend\n\nto go \n  set step step + 1\n  shine-light\n  if day-night? = true\n   [day-night-cycle]\n  takeup-water\n  move-chloroplast\n  color-sky\n  set-CO2\n  photosynthesize\n  make-oxygen\n  make-sugar\n  make-water-vapor\n  ask sugar [\n    fd .1\n    if ycor < min-pycor + 1 \n       [die]\n    ]\n  ask oxygen [\n    fd .2 \n    set heading heading - 10 + random 20\n    if abs xcor > max-pxcor - 1 or abs ycor > max-pycor - 1\n      [die]\n  ]\n  \n   ask vapor [\n    fd .2 \n    set heading heading - 10 + random 20\n    if abs xcor > max-pxcor - 1 or abs ycor > max-pycor - 1\n      [die]\n  ]\n  plot-stuff\n  tick\nend\n\n;;SETUP PROCEDURES\n\nto createplant\nask patches [\n  set  pcolor 103\n  if pycor <= -15 and pycor > -17 [set pcolor brown]\n  if pycor <= -17 [set pcolor green ]\n]\nend\n\nto createsun\ncreate-sun 1 [\n  set xcor -7\n  set ycor max-pycor - 3\n  set heading 90\n  set color yellow\n  set size 4\n  set shape \"circle\"\n  set day? true\n  ]\nend\n\nto createchloroplast\ncreate-chloroplast 10 \n  [setxy (5 - random 10)  (5 - random 10)\n  set color 64\n  set shape \"circle\"\n  set size 4\n  set NADPH? false\n  ]\nend\n\n;;GO PROCEDURES\n\nto move-chloroplast\nask chloroplast \n  [fd .05\n  set heading heading + (10 - random 20)\n  if distancexy 0 0 > 7 [ rt 180 ] \n  ]\nend\n\nto shine-light\nif day? = true [\nif random 100 < sun-brightness [\n    create-light 1\n        [set color yellow + 3\n        set size 2\n        setxy [xcor] of (one-of sun) [ycor] of (one-of sun)\n        set heading 240 - random 120\n        set xcor xcor + random 5 - 2\n        fd 1\n        ]\n     ]\n]\nask light [\n    fd .5\n    if abs xcor > max-pycor - 1 [die]\n    if ycor < -14 [die]\n     ]\n\nend\n\nto  day-night-cycle\nask sun [ \n  fd .05\n  if xcor >= (max-pxcor - 1) and old-xcor < (max-pxcor - 1)\n    [ifelse day? = true \n      [ set day? false ]\n      [set day? true]\n    ]\n  ifelse day? = true\n    [set color yellow]\n    [set color 9]\n ]\n ask sun [\n    set old-xcor xcor\n ] \nend\n\nto takeup-water\nif random 100 < water-flow [\ncreate-water 1\n  [set color blue\n  set shape \"circle\"\n  set size 2\n  setxy min-pxcor (- 16 - random 4) \n  set heading 90\n  fd 1\n  ]]\nask water [\n  if xcor > max-pxcor - 1 [die]\n  if abs xcor < 3 and ycor < -15 and random 100 < 5  and (count water with [ycor > -5]) < 20 \n    [set heading 0]\n  if ycor > -7\n    [set water-in-leaf? true]\n  if water-in-leaf? = true and distancexy 0 0 > 8 [\n    rt 180\n    fd 1\n    ]\n  if distancexy 0 0 < 7 [set heading heading + (10 - random 20)]\n    fd .3\n  ]\nend\n\nto set-CO2\nif count CO2 < CO2-amount [\n   create-CO2 1\n    [\n     set shape \"CO2\"\n     set size 3\n     setxy random max-pxcor random max-pycor\n     set heading random 360\n    ]\n]\nask CO2 [\n    set heading heading + (10 - random 20)\n    fd .5\n    if ycor > (max-pycor - 1) or ycor < min-pycor + 6 [\n    rt 180\n    fd 1\n    ] \n  ]\nend\n\nto photosynthesize\nask chloroplast [\n   if NADPH? = false \n   and count (light in-radius 2) > 0\n   and count (water in-radius 2) > 0 [\n        set NADPH? true\n        set size 5 \n        set color orange\n        set O2-temp-count O2-temp-count + 1   \n        ask one-of (water in-radius 2) [ die ] \n        ask one-of (light in-radius 2) [ die ] \n      ]\n \n  If NADPH? = true \n    and count (CO2 in-radius 2) > 0 \n    and count (water in-radius 2) > 0 [\n      ask one-of (CO2 in-radius 2) [ die ]\n      ask one-of (water in-radius 2) [ die ] \n      set sugar-temp-count sugar-temp-count + 1\n            set vapor-temp-count vapor-temp-count + 1\n      set NADPH? false\n      set size 4\n      set color 64\n      ]\n]\nend\n\nto make-oxygen\nif O2-temp-count > 0 [\n  create-oxygen 1\n    [set color gray + 1\n    set shape \"oxygen\"\n    set size 2\n    set heading random 360\n    ]\n  set O2-temp-count O2-temp-count - 1\n]\nend\n\nto  make-sugar \nif sugar-temp-count > 0 [\n  create-sugar 1\n    [setxy 0 0\n    set shape \"sugar\"\n    set color white\n    set size 2\n    set heading 180\n    ]\n  set sugar-temp-count sugar-temp-count - 1 \n]\n\nend\n\nto   make-water-vapor\nif vapor-temp-count > 0 [\n  create-vapor 1\n    [setxy 0 0\n    set shape \"vapor\"\n    set color blue + 2\n    set size 2\n    set heading random 360\n    ]\n  set vapor-temp-count vapor-temp-count - 1 \n]\nend\n\n\nto color-sky\nif step mod 10 = 0 [\nask patches [\n  if pycor > -15 \n    [set pcolor (scale-color blue (count light) -30 60)]\n   ]\n]\nend\n\nto plot-stuff\n;;set-current-plot \"Production Rates\"\n ;; set-current-plot-pen \"oxygen\"\n  ;;    plot count oxygen\n ;;   set-current-plot-pen \"Sugar\"\n ;;     plot count sugar\n   ;; set-current-plot-pen \"Vapor\"\n     ;; plot count vapor\n\nend";
          var info    = "## WHAT IS IT?\n\nThis is a model of photosynthesis in a chloroplast which is inside a leaf. \n\n## HOW IT WORKS\n\nThe following inputs can be adjusted with sliders:  \n-- light rays radiating from the sun (yellow arrowheads)  \n-- water supplied to the stem (blue circles)  \n-- carbon dioxide (CO2) molecules in the atmosphere (orange and black)\n\nIn the center of the leaf is a black circle representing a chloroplast. The rules for the model are as follows:  \n1. Water in the stem is drawn up into the leaf as it goes by, up to a maximum of 30 water molecules.  \n2. If a light ray and a water molecule are both inside the chloroplast, it goes into an excited state (NADPH). The circle gets larger and turns orange. One water is used up and one oxygen (gray circle) is created.  \n3. If a CO2 and a water are both inside the chloroplast when it is in an excited state,  \nit returns to an unexcited state. The circle gets smaller and turns black. One CO2 is used up and one sugar (white jagged shape) is created.  \n4. The sugars go down the leaf stem and disappear. The idea is that they are being used by the plant in some way ï¿½ to build leaves, stems, roots, and seeds for instance. The sugar production rate on the graph is the number of sugars on the screen at any moment.  \n5. The oxygens go out in all directions and disappear when they get to the edge of the screen. The oxygen production rate on the graph is the number of oxygens on the screen at any moment.\n\n## HOW TO USE IT\n\nThis section could explain how to use the model, including a description of each of the items in the interface tab.\n\n## THINGS TO NOTICE\n\nThis section could give some ideas of things for the user to notice while running the model.\n\n## THINGS TO TRY\n\nThis section could give some ideas of things for the user to try to do (move sliders, switches, etc.) with the model.\n\n## EXTENDING THE MODEL\n\nThis section could give some ideas of things to add or change in the procedures tab to make the model more complicated, detailed, accurate, etc.\n\n## NETLOGO FEATURES\n\nThis section could point out any especially interesting or unusual features of NetLogo that the model makes use of, particularly in the Procedures tab.  It might also point out places where workarounds were needed because of missing features.\n\n## RELATED MODELS\n\nThis section could give the names of models in the NetLogo Models Library or elsewhere which are of related interest.\n\n## CREDITS AND REFERENCES\n\nThis section could contain a reference to the model's URL on the web if it has one, as well as any other necessary credits or references.";
          return Tortoise.fromCompiledModel('#model-container', widgets, code, info, '', true);
        })();
      var AgentModel = tortoise_require('agentmodel');
var Call = tortoise_require('util/call');
var ColorModel = tortoise_require('engine/core/colormodel');
var Dump = tortoise_require('engine/dump');
var Exception = tortoise_require('util/exception');
var Link = tortoise_require('engine/core/link');
var LinkSet = tortoise_require('engine/core/linkset');
var Meta = tortoise_require('meta');
var NLMath = tortoise_require('util/nlmath');
var NLType = tortoise_require('engine/core/typechecker');
var Nobody = tortoise_require('engine/core/nobody');
var PatchSet = tortoise_require('engine/core/patchset');
var PenBundle = tortoise_require('engine/plot/pen');
var Plot = tortoise_require('engine/plot/plot');
var PlotOps = tortoise_require('engine/plot/plotops');
var Random = tortoise_require('shim/random');
var StrictMath = tortoise_require('shim/strictmath');
var Tasks = tortoise_require('engine/prim/tasks');
var Turtle = tortoise_require('engine/core/turtle');
var TurtleSet = tortoise_require('engine/core/turtleset');
var notImplemented = tortoise_require('util/notimplemented');
var modelConfig = (typeof window.modelConfig !== "undefined" && window.modelConfig !== null) ? window.modelConfig : {};
var modelPlotOps = (typeof modelConfig.plotOps !== "undefined" && modelConfig.plotOps !== null) ? modelConfig.plotOps : {};
if (typeof javax !== "undefined") {
  modelConfig.output = {
    clear: function() {},
    write: function(str) { context.getWriter().print(str); }
  }
}
modelConfig.plots = [];
var workspace = tortoise_require('engine/workspace')(modelConfig)([{ name: "LIGHT", singular: "turtle", varNames: [] }, { name: "SUN", singular: "turtle", varNames: ["old-xcor"] }, { name: "SUGAR", singular: "turtle", varNames: [] }, { name: "CO2", singular: "turtle", varNames: [] }, { name: "OXYGEN", singular: "turtle", varNames: [] }, { name: "WATER", singular: "turtle", varNames: [] }, { name: "VAPOR", singular: "turtle", varNames: [] }, { name: "CHLOROPLAST", singular: "turtle", varNames: ["nadph?"] }])(["water-in-leaf?"], [])(["water-flow", "co2-amount", "sun-brightness", "day-night?", "sugarcount", "sugarcount-old", "sugar-rate", "oxygencount", "o2-temp-count", "vapor-temp-count", "sugar-temp-count", "step", "time-unit", "day?", "sugarsmoothed", "sugarsmoothed-old", "sugar-rate-smoothed", "smoothness", "smoothness-2", "percent-excited"], ["water-flow", "co2-amount", "sun-brightness", "day-night?"], [], -20, 20, -20, 20, 8.0, true, true, {"default":{"rotate":true,"elements":[{"xcors":[150,40,150,260],"ycors":[5,250,205,250],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"airplane":{"rotate":true,"elements":[{"xcors":[150,135,120,120,15,15,120,135,105,120,150,180,210,165,180,285,285,180,180,165],"ycors":[0,15,60,105,165,195,180,240,270,285,270,285,270,240,180,195,165,105,60,15],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"arrow":{"rotate":true,"elements":[{"xcors":[150,0,105,105,195,195,300],"ycors":[0,150,150,293,293,150,150],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"box":{"rotate":false,"elements":[{"xcors":[150,285,285,150],"ycors":[285,225,75,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[150,15,150,285],"ycors":[135,75,15,75],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[15,15,150,150],"ycors":[75,225,285,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":150,"y1":285,"x2":150,"y2":135,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x1":150,"y1":135,"x2":15,"y2":75,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x1":150,"y1":135,"x2":285,"y2":75,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false}]},"bug":{"rotate":true,"elements":[{"x":96,"y":182,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":110,"y":127,"diam":80,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":110,"y":75,"diam":80,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":150,"y1":100,"x2":80,"y2":30,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":150,"y1":100,"x2":220,"y2":30,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"butterfly":{"rotate":true,"elements":[{"xcors":[150,209,225,225,195,165,150],"ycors":[165,199,225,255,270,255,240],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[150,89,75,75,105,135,150],"ycors":[165,198,225,255,270,255,240],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[139,100,55,25,10,10,25,40,85,139],"ycors":[148,105,90,90,105,135,180,195,194,163],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[162,200,245,275,290,290,275,260,215,162],"ycors":[150,105,90,90,105,135,180,195,195,165],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[150,135,120,135,150,165,180,165],"ycors":[255,225,150,120,105,120,150,225],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":135,"y":90,"diam":30,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x1":150,"y1":105,"x2":195,"y2":60,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x1":150,"y1":105,"x2":105,"y2":60,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false}]},"car":{"rotate":false,"elements":[{"xcors":[300,279,261,240,226,213,203,185,159,135,75,0,0,0,300,300],"ycors":[180,164,144,135,132,106,84,63,50,50,60,150,165,225,225,180],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":180,"y":180,"diam":90,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":30,"y":180,"diam":90,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[162,132,134,209,194,189,180],"ycors":[80,78,135,135,105,96,89],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":47,"y":195,"diam":58,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":195,"y":195,"diam":58,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"circle":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"circle 2":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":30,"y":30,"diam":240,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"circle-edge":{"rotate":true,"elements":[{"x":12,"y":12,"diam":277,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":true},{"x":21,"y":21,"diam":258,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":true},{"x":23,"y":23,"diam":255,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":true},{"x":30,"y":30,"diam":240,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":true}]},"co2":{"rotate":true,"elements":[{"x":26,"y":116,"diam":67,"type":"circle","color":"rgba(241, 106, 21, 1.0)","filled":true,"marked":false},{"x":26,"y":116,"diam":67,"type":"circle","color":"rgba(241, 106, 21, 1.0)","filled":true,"marked":false},{"x":191,"y":116,"diam":67,"type":"circle","color":"rgba(241, 106, 21, 1.0)","filled":true,"marked":false},{"x":75,"y":75,"diam":150,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":101,"y":101,"diam":67,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":73,"y":73,"diam":152,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":18,"y":108,"diam":85,"type":"circle","color":"rgba(241, 106, 21, 1.0)","filled":false,"marked":false},{"x":183,"y":108,"diam":85,"type":"circle","color":"rgba(241, 106, 21, 1.0)","filled":false,"marked":false}]},"cow":{"rotate":false,"elements":[{"xcors":[200,197,179,177,166,140,93,78,72,49,48,37,25,25,45,103,179,198,252,272,293,285,255,242,224],"ycors":[193,249,249,196,187,189,191,179,211,209,181,149,120,89,72,84,75,76,64,81,103,121,121,118,167],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[73,86,62,48],"ycors":[210,251,249,208],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[25,16,9,23,25,39],"ycors":[114,195,204,213,200,123],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"cylinder":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"dot":{"rotate":false,"elements":[{"x":90,"y":90,"diam":120,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"face happy":{"rotate":false,"elements":[{"x":8,"y":8,"diam":285,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":60,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":180,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[150,90,62,47,67,90,109,150,192,210,227,251,236,212],"ycors":[255,239,213,191,179,203,218,225,218,203,181,194,217,240],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"face neutral":{"rotate":false,"elements":[{"x":8,"y":7,"diam":285,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":60,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":180,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":60,"ymin":195,"xmax":240,"ymax":225,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"face sad":{"rotate":false,"elements":[{"x":8,"y":8,"diam":285,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":60,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":180,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[150,90,62,47,67,90,109,150,192,210,227,251,236,212],"ycors":[168,184,210,232,244,220,205,198,205,220,242,229,206,183],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"fish":{"rotate":false,"elements":[{"xcors":[44,21,15,0,15,0,13,20,45],"ycors":[131,87,86,120,150,180,214,212,166],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[135,119,95,76,46,60],"ycors":[195,235,218,210,204,165],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[75,83,71,86,166,135],"ycors":[45,77,103,114,78,60],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[30,151,226,280,292,292,287,270,195,151,30],"ycors":[136,77,81,119,146,160,170,195,210,212,166],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":215,"y":106,"diam":30,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"flag":{"rotate":false,"elements":[{"xmin":60,"ymin":15,"xmax":75,"ymax":300,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[90,270,90],"ycors":[150,90,30],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":75,"y1":135,"x2":90,"y2":135,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":75,"y1":45,"x2":90,"y2":45,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"flower":{"rotate":false,"elements":[{"xcors":[135,165,180,180,150,165,195,195,165],"ycors":[120,165,210,240,300,300,240,195,135],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"x":85,"y":132,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":130,"y":147,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":192,"y":85,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":85,"y":40,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":177,"y":40,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":177,"y":132,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":70,"y":85,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":130,"y":25,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":96,"y":51,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":113,"y":68,"diam":74,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[189,219,249,279,234],"ycors":[233,188,173,188,218],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[180,150,105,75,135],"ycors":[255,210,210,240,240],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false}]},"house":{"rotate":false,"elements":[{"xmin":45,"ymin":120,"xmax":255,"ymax":285,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":120,"ymin":210,"xmax":180,"ymax":285,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[15,150,285],"ycors":[120,15,120],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":30,"y1":120,"x2":270,"y2":120,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false}]},"leaf":{"rotate":false,"elements":[{"xcors":[150,135,120,60,30,60,60,15,30,15,40,45,60,90,105,120,105,120,135,150,165,180,195,180,195,210,240,255,263,285,270,285,240,240,270,240,180,165],"ycors":[210,195,210,210,195,180,165,135,120,105,104,90,90,105,120,120,60,60,30,15,30,60,60,120,120,105,90,90,104,105,120,135,165,180,195,210,210,195],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,135,120,105,105,135,165,165],"ycors":[195,240,255,255,285,285,240,195],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"line":{"rotate":true,"elements":[{"x1":150,"y1":0,"x2":150,"y2":300,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"line half":{"rotate":true,"elements":[{"x1":150,"y1":0,"x2":150,"y2":150,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"link":{"rotate":true,"elements":[{"x1":150,"y1":0,"x2":150,"y2":300,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"link direction":{"rotate":true,"elements":[{"x1":150,"y1":150,"x2":30,"y2":225,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":150,"y1":150,"x2":270,"y2":225,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"oxygen":{"rotate":true,"elements":[{"x":5,"y":65,"diam":170,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":125,"y":65,"diam":170,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"pentagon":{"rotate":false,"elements":[{"xcors":[150,15,60,240,285],"ycors":[15,120,285,285,120],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"person":{"rotate":false,"elements":[{"x":110,"y":5,"diam":80,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[105,120,90,105,135,150,165,195,210,180,195],"ycors":[90,195,285,300,300,225,300,300,285,195,90],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":127,"ymin":79,"xmax":172,"ymax":94,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[195,240,225,165],"ycors":[90,150,180,105],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[105,60,75,135],"ycors":[90,150,180,105],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"plant":{"rotate":false,"elements":[{"xmin":135,"ymin":90,"xmax":165,"ymax":300,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,90,45,75,135],"ycors":[255,210,195,255,285],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[165,210,255,225,165],"ycors":[255,210,195,255,285],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,90,45,75,135],"ycors":[180,135,120,180,210],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[165,165,225,255,210],"ycors":[180,210,180,120,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,90,45,75,135],"ycors":[105,60,45,105,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[165,165,225,255,210],"ycors":[105,135,105,45,60],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,120,150,180,165],"ycors":[90,45,15,45,90],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"square":{"rotate":false,"elements":[{"xmin":30,"ymin":30,"xmax":270,"ymax":270,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"square 2":{"rotate":false,"elements":[{"xmin":30,"ymin":30,"xmax":270,"ymax":270,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":60,"ymin":60,"xmax":240,"ymax":240,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"star":{"rotate":false,"elements":[{"xcors":[151,185,298,207,242,151,59,94,3,116],"ycors":[1,108,108,175,282,216,282,175,108,108],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"sugar":{"rotate":true,"elements":[{"xcors":[75,135,165,255,225,285,195,240,150,135,75,75,15,105,15,90,75],"ycors":[60,15,60,60,120,165,180,255,255,210,255,210,195,150,90,75,60],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true}]},"target":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":30,"y":30,"diam":240,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":60,"y":60,"diam":180,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":90,"y":90,"diam":120,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":120,"y":120,"diam":60,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"tree":{"rotate":false,"elements":[{"x":118,"y":3,"diam":94,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":120,"ymin":195,"xmax":180,"ymax":300,"type":"rectangle","color":"rgba(157, 110, 72, 1.0)","filled":true,"marked":false},{"x":65,"y":21,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":116,"y":41,"diam":127,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":45,"y":90,"diam":120,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":104,"y":74,"diam":152,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"triangle":{"rotate":false,"elements":[{"xcors":[150,15,285],"ycors":[30,255,255],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"triangle 2":{"rotate":false,"elements":[{"xcors":[150,15,285],"ycors":[30,255,255],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[151,225,75],"ycors":[99,223,224],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"truck":{"rotate":false,"elements":[{"xmin":4,"ymin":45,"xmax":195,"ymax":187,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[296,296,259,244,208,207],"ycors":[193,150,134,104,104,194],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":195,"ymin":60,"xmax":195,"ymax":105,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[238,252,219,218],"ycors":[112,141,141,112],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":234,"y":174,"diam":42,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":181,"ymin":185,"xmax":214,"ymax":194,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":144,"y":174,"diam":42,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":24,"y":174,"diam":42,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":24,"y":174,"diam":42,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":144,"y":174,"diam":42,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":234,"y":174,"diam":42,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"turtle":{"rotate":true,"elements":[{"xcors":[215,240,246,228,215,193],"ycors":[204,233,254,266,252,210],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[195,225,245,260,269,261,240,225,210],"ycors":[90,75,75,89,108,124,105,105,105],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[105,75,55,40,31,39,60,75,90],"ycors":[90,75,75,89,108,124,105,105,105],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[132,134,107,108,150,192,192,169,172],"ycors":[85,64,51,17,2,18,52,65,87],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[85,60,54,72,85,107],"ycors":[204,233,254,266,252,210],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[119,179,209,224,220,175,128,81,74,88],"ycors":[75,75,101,135,225,261,261,224,135,99],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"vapor":{"rotate":true,"elements":[{"x":63,"y":198,"diam":85,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"x":78,"y":3,"diam":85,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"x":48,"y":33,"diam":234,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"wheel":{"rotate":false,"elements":[{"x":3,"y":3,"diam":294,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":30,"y":30,"diam":240,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x1":150,"y1":285,"x2":150,"y2":15,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":15,"y1":150,"x2":285,"y2":150,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":120,"y":120,"diam":60,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":216,"y1":40,"x2":79,"y2":269,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":40,"y1":84,"x2":269,"y2":221,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":40,"y1":216,"x2":269,"y2":79,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":84,"y1":40,"x2":221,"y2":269,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"x":{"rotate":false,"elements":[{"xcors":[270,225,30,75],"ycors":[75,30,225,270],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[30,75,270,225],"ycors":[75,30,225,270],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]}}, {"default":{"direction-indicator":{"rotate":true,"elements":[{"x1":150,"y1":150,"x2":90,"y2":180,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":150,"y1":150,"x2":210,"y2":180,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"curviness":0.0,"lines":[{"x-offset":-0.2,"is-visible":false,"dash-pattern":[0.0,1.0]},{"x-offset":0.0,"is-visible":true,"dash-pattern":[1.0,0.0]},{"x-offset":0.2,"is-visible":false,"dash-pattern":[0.0,1.0]}]}}, function(){});
var BreedManager = workspace.breedManager;
var LayoutManager = workspace.layoutManager;
var LinkPrims = workspace.linkPrims;
var ListPrims = workspace.listPrims;
var MousePrims = workspace.mousePrims;
var OutputPrims = workspace.outputPrims;
var Prims = workspace.prims;
var PrintPrims = workspace.printPrims;
var SelfManager = workspace.selfManager;
var SelfPrims = workspace.selfPrims;
var Updater = workspace.updater;
var plotManager = workspace.plotManager;
var world = workspace.world;
var procedures = (function() {
  var startup = function() { Call(procedures.setup); };
  var setup = function() {
    world.clearAll();
    Call(procedures.myImportDrawing, "aspenleaftrans.png");
    Call(procedures.createplant);
    Call(procedures.createsun);
    Call(procedures.createchloroplast);
    world.turtleManager.turtlesOfBreed("WATER").ask(function() { SelfPrims.setVariable("water-in-leaf?", false); }, true);
    world.observer.setGlobal("day?", true);
    world.observer.setGlobal("sun-brightness", 36);
    world.observer.setGlobal("co2-amount", 14);
    world.observer.setGlobal("water-flow", 10);
    world.ticker.reset();
  };
  var myImportDrawing = function(src) {};
  var go = function() {
    world.observer.setGlobal("step", (world.observer.getGlobal("step") + 1));
    Call(procedures.shineLight);
    if (Prims.equality(world.observer.getGlobal("day-night?"), true)) {
      Call(procedures.dayNightCycle);
    }
    Call(procedures.takeupWater);
    Call(procedures.moveChloroplast);
    Call(procedures.colorSky);
    Call(procedures.setCo2);
    Call(procedures.photosynthesize);
    Call(procedures.makeOxygen);
    Call(procedures.makeSugar);
    Call(procedures.makeWaterVapor);
    world.turtleManager.turtlesOfBreed("SUGAR").ask(function() {
      SelfPrims.fd(0.1);
      if (Prims.lt(SelfPrims.getVariable("ycor"), (world.topology.minPycor + 1))) {
        SelfPrims.die();
      }
    }, true);
    world.turtleManager.turtlesOfBreed("OXYGEN").ask(function() {
      SelfPrims.fd(0.2);
      SelfPrims.setVariable("heading", ((SelfPrims.getVariable("heading") - 10) + Prims.random(20)));
      if ((Prims.gt(NLMath.abs(SelfPrims.getVariable("xcor")), (world.topology.maxPxcor - 1)) || Prims.gt(NLMath.abs(SelfPrims.getVariable("ycor")), (world.topology.maxPycor - 1)))) {
        SelfPrims.die();
      }
    }, true);
    world.turtleManager.turtlesOfBreed("VAPOR").ask(function() {
      SelfPrims.fd(0.2);
      SelfPrims.setVariable("heading", ((SelfPrims.getVariable("heading") - 10) + Prims.random(20)));
      if ((Prims.gt(NLMath.abs(SelfPrims.getVariable("xcor")), (world.topology.maxPxcor - 1)) || Prims.gt(NLMath.abs(SelfPrims.getVariable("ycor")), (world.topology.maxPycor - 1)))) {
        SelfPrims.die();
      }
    }, true);
    Call(procedures.plotStuff);
    world.ticker.tick();
  };
  var createplant = function() {
    world.patches().ask(function() {
      SelfPrims.setPatchVariable("pcolor", 103);
      if ((Prims.lte(SelfPrims.getPatchVariable("pycor"), -15) && Prims.gt(SelfPrims.getPatchVariable("pycor"), -17))) {
        SelfPrims.setPatchVariable("pcolor", 35);
      }
      if (Prims.lte(SelfPrims.getPatchVariable("pycor"), -17)) {
        SelfPrims.setPatchVariable("pcolor", 55);
      }
    }, true);
  };
  var createsun = function() {
    world.turtleManager.createTurtles(1, "SUN").ask(function() {
      SelfPrims.setVariable("xcor", -7);
      SelfPrims.setVariable("ycor", (world.topology.maxPycor - 3));
      SelfPrims.setVariable("heading", 90);
      SelfPrims.setVariable("color", 45);
      SelfPrims.setVariable("size", 4);
      SelfPrims.setVariable("shape", "circle");
      world.observer.setGlobal("day?", true);
    }, true);
  };
  var createchloroplast = function() {
    world.turtleManager.createTurtles(10, "CHLOROPLAST").ask(function() {
      SelfPrims.setXY((5 - Prims.random(10)), (5 - Prims.random(10)));
      SelfPrims.setVariable("color", 64);
      SelfPrims.setVariable("shape", "circle");
      SelfPrims.setVariable("size", 4);
      SelfPrims.setVariable("nadph?", false);
    }, true);
  };
  var moveChloroplast = function() {
    world.turtleManager.turtlesOfBreed("CHLOROPLAST").ask(function() {
      SelfPrims.fd(0.05);
      SelfPrims.setVariable("heading", (SelfPrims.getVariable("heading") + (10 - Prims.random(20))));
      if (Prims.gt(SelfManager.self().distanceXY(0, 0), 7)) {
        SelfPrims.right(180);
      }
    }, true);
  };
  var shineLight = function() {
    if (Prims.equality(world.observer.getGlobal("day?"), true)) {
      if (Prims.lt(Prims.random(100), world.observer.getGlobal("sun-brightness"))) {
        world.turtleManager.createTurtles(1, "LIGHT").ask(function() {
          SelfPrims.setVariable("color", (45 + 3));
          SelfPrims.setVariable("size", 2);
          SelfPrims.setXY(ListPrims.oneOf(world.turtleManager.turtlesOfBreed("SUN")).projectionBy(function() { return SelfPrims.getVariable("xcor"); }), ListPrims.oneOf(world.turtleManager.turtlesOfBreed("SUN")).projectionBy(function() { return SelfPrims.getVariable("ycor"); }));
          SelfPrims.setVariable("heading", (240 - Prims.random(120)));
          SelfPrims.setVariable("xcor", ((SelfPrims.getVariable("xcor") + Prims.random(5)) - 2));
          SelfPrims.fd(1);
        }, true);
      }
    }
    world.turtleManager.turtlesOfBreed("LIGHT").ask(function() {
      SelfPrims.fd(0.5);
      if (Prims.gt(NLMath.abs(SelfPrims.getVariable("xcor")), (world.topology.maxPycor - 1))) {
        SelfPrims.die();
      }
      if (Prims.lt(SelfPrims.getVariable("ycor"), -14)) {
        SelfPrims.die();
      }
    }, true);
  };
  var dayNightCycle = function() {
    world.turtleManager.turtlesOfBreed("SUN").ask(function() {
      SelfPrims.fd(0.05);
      if ((Prims.gte(SelfPrims.getVariable("xcor"), (world.topology.maxPxcor - 1)) && Prims.lt(SelfPrims.getVariable("old-xcor"), (world.topology.maxPxcor - 1)))) {
        if (Prims.equality(world.observer.getGlobal("day?"), true)) {
          world.observer.setGlobal("day?", false);
        }
        else {
          world.observer.setGlobal("day?", true);
        }
      }
      if (Prims.equality(world.observer.getGlobal("day?"), true)) {
        SelfPrims.setVariable("color", 45);
      }
      else {
        SelfPrims.setVariable("color", 9);
      }
    }, true);
    world.turtleManager.turtlesOfBreed("SUN").ask(function() { SelfPrims.setVariable("old-xcor", SelfPrims.getVariable("xcor")); }, true);
  };
  var takeupWater = function() {
    if (Prims.lt(Prims.random(100), world.observer.getGlobal("water-flow"))) {
      world.turtleManager.createTurtles(1, "WATER").ask(function() {
        SelfPrims.setVariable("color", 105);
        SelfPrims.setVariable("shape", "circle");
        SelfPrims.setVariable("size", 2);
        SelfPrims.setXY(world.topology.minPxcor, ( -16 - Prims.random(4)));
        SelfPrims.setVariable("heading", 90);
        SelfPrims.fd(1);
      }, true);
    }
    world.turtleManager.turtlesOfBreed("WATER").ask(function() {
      if (Prims.gt(SelfPrims.getVariable("xcor"), (world.topology.maxPxcor - 1))) {
        SelfPrims.die();
      }
      if ((((Prims.lt(NLMath.abs(SelfPrims.getVariable("xcor")), 3) && Prims.lt(SelfPrims.getVariable("ycor"), -15)) && Prims.lt(Prims.random(100), 5)) && Prims.lt(world.turtleManager.turtlesOfBreed("WATER").agentFilter(function() { return Prims.gt(SelfPrims.getVariable("ycor"), -5); }).size(), 20))) {
        SelfPrims.setVariable("heading", 0);
      }
      if (Prims.gt(SelfPrims.getVariable("ycor"), -7)) {
        SelfPrims.setVariable("water-in-leaf?", true);
      }
      if ((Prims.equality(SelfPrims.getVariable("water-in-leaf?"), true) && Prims.gt(SelfManager.self().distanceXY(0, 0), 8))) {
        SelfPrims.right(180);
        SelfPrims.fd(1);
      }
      if (Prims.lt(SelfManager.self().distanceXY(0, 0), 7)) {
        SelfPrims.setVariable("heading", (SelfPrims.getVariable("heading") + (10 - Prims.random(20))));
      }
      SelfPrims.fd(0.3);
    }, true);
  };
  var setCo2 = function() {
    if (Prims.lt(world.turtleManager.turtlesOfBreed("CO2").size(), world.observer.getGlobal("co2-amount"))) {
      world.turtleManager.createTurtles(1, "CO2").ask(function() {
        SelfPrims.setVariable("shape", "CO2");
        SelfPrims.setVariable("size", 3);
        SelfPrims.setXY(Prims.random(world.topology.maxPxcor), Prims.random(world.topology.maxPycor));
        SelfPrims.setVariable("heading", Prims.random(360));
      }, true);
    }
    world.turtleManager.turtlesOfBreed("CO2").ask(function() {
      SelfPrims.setVariable("heading", (SelfPrims.getVariable("heading") + (10 - Prims.random(20))));
      SelfPrims.fd(0.5);
      if ((Prims.gt(SelfPrims.getVariable("ycor"), (world.topology.maxPycor - 1)) || Prims.lt(SelfPrims.getVariable("ycor"), (world.topology.minPycor + 6)))) {
        SelfPrims.right(180);
        SelfPrims.fd(1);
      }
    }, true);
  };
  var photosynthesize = function() {
    world.turtleManager.turtlesOfBreed("CHLOROPLAST").ask(function() {
      if (((Prims.equality(SelfPrims.getVariable("nadph?"), false) && Prims.gt(SelfManager.self().inRadius(world.turtleManager.turtlesOfBreed("LIGHT"), 2).size(), 0)) && Prims.gt(SelfManager.self().inRadius(world.turtleManager.turtlesOfBreed("WATER"), 2).size(), 0))) {
        SelfPrims.setVariable("nadph?", true);
        SelfPrims.setVariable("size", 5);
        SelfPrims.setVariable("color", 25);
        world.observer.setGlobal("o2-temp-count", (world.observer.getGlobal("o2-temp-count") + 1));
        ListPrims.oneOf(SelfManager.self().inRadius(world.turtleManager.turtlesOfBreed("WATER"), 2)).ask(function() { SelfPrims.die(); }, true);
        ListPrims.oneOf(SelfManager.self().inRadius(world.turtleManager.turtlesOfBreed("LIGHT"), 2)).ask(function() { SelfPrims.die(); }, true);
      }
      if (((Prims.equality(SelfPrims.getVariable("nadph?"), true) && Prims.gt(SelfManager.self().inRadius(world.turtleManager.turtlesOfBreed("CO2"), 2).size(), 0)) && Prims.gt(SelfManager.self().inRadius(world.turtleManager.turtlesOfBreed("WATER"), 2).size(), 0))) {
        ListPrims.oneOf(SelfManager.self().inRadius(world.turtleManager.turtlesOfBreed("CO2"), 2)).ask(function() { SelfPrims.die(); }, true);
        ListPrims.oneOf(SelfManager.self().inRadius(world.turtleManager.turtlesOfBreed("WATER"), 2)).ask(function() { SelfPrims.die(); }, true);
        world.observer.setGlobal("sugar-temp-count", (world.observer.getGlobal("sugar-temp-count") + 1));
        world.observer.setGlobal("vapor-temp-count", (world.observer.getGlobal("vapor-temp-count") + 1));
        SelfPrims.setVariable("nadph?", false);
        SelfPrims.setVariable("size", 4);
        SelfPrims.setVariable("color", 64);
      }
    }, true);
  };
  var makeOxygen = function() {
    if (Prims.gt(world.observer.getGlobal("o2-temp-count"), 0)) {
      world.turtleManager.createTurtles(1, "OXYGEN").ask(function() {
        SelfPrims.setVariable("color", (5 + 1));
        SelfPrims.setVariable("shape", "oxygen");
        SelfPrims.setVariable("size", 2);
        SelfPrims.setVariable("heading", Prims.random(360));
      }, true);
      world.observer.setGlobal("o2-temp-count", (world.observer.getGlobal("o2-temp-count") - 1));
    }
  };
  var makeSugar = function() {
    if (Prims.gt(world.observer.getGlobal("sugar-temp-count"), 0)) {
      world.turtleManager.createTurtles(1, "SUGAR").ask(function() {
        SelfPrims.setXY(0, 0);
        SelfPrims.setVariable("shape", "sugar");
        SelfPrims.setVariable("color", 9.9);
        SelfPrims.setVariable("size", 2);
        SelfPrims.setVariable("heading", 180);
      }, true);
      world.observer.setGlobal("sugar-temp-count", (world.observer.getGlobal("sugar-temp-count") - 1));
    }
  };
  var makeWaterVapor = function() {
    if (Prims.gt(world.observer.getGlobal("vapor-temp-count"), 0)) {
      world.turtleManager.createTurtles(1, "VAPOR").ask(function() {
        SelfPrims.setXY(0, 0);
        SelfPrims.setVariable("shape", "vapor");
        SelfPrims.setVariable("color", (105 + 2));
        SelfPrims.setVariable("size", 2);
        SelfPrims.setVariable("heading", Prims.random(360));
      }, true);
      world.observer.setGlobal("vapor-temp-count", (world.observer.getGlobal("vapor-temp-count") - 1));
    }
  };
  var colorSky = function() {
    if (Prims.equality(NLMath.mod(world.observer.getGlobal("step"), 10), 0)) {
      world.patches().ask(function() {
        if (Prims.gt(SelfPrims.getPatchVariable("pycor"), -15)) {
          SelfPrims.setPatchVariable("pcolor", ColorModel.scaleColor(105, world.turtleManager.turtlesOfBreed("LIGHT").size(), -30, 60));
        }
      }, true);
    }
  };
  var plotStuff = function() {};
  return {
    "COLOR-SKY":colorSky,
    "CREATECHLOROPLAST":createchloroplast,
    "CREATEPLANT":createplant,
    "CREATESUN":createsun,
    "DAY-NIGHT-CYCLE":dayNightCycle,
    "GO":go,
    "MAKE-OXYGEN":makeOxygen,
    "MAKE-SUGAR":makeSugar,
    "MAKE-WATER-VAPOR":makeWaterVapor,
    "MOVE-CHLOROPLAST":moveChloroplast,
    "MY-IMPORT-DRAWING":myImportDrawing,
    "PHOTOSYNTHESIZE":photosynthesize,
    "PLOT-STUFF":plotStuff,
    "SET-CO2":setCo2,
    "SETUP":setup,
    "SHINE-LIGHT":shineLight,
    "STARTUP":startup,
    "TAKEUP-WATER":takeupWater,
    "colorSky":colorSky,
    "createchloroplast":createchloroplast,
    "createplant":createplant,
    "createsun":createsun,
    "dayNightCycle":dayNightCycle,
    "go":go,
    "makeOxygen":makeOxygen,
    "makeSugar":makeSugar,
    "makeWaterVapor":makeWaterVapor,
    "moveChloroplast":moveChloroplast,
    "myImportDrawing":myImportDrawing,
    "photosynthesize":photosynthesize,
    "plotStuff":plotStuff,
    "setCo2":setCo2,
    "setup":setup,
    "shineLight":shineLight,
    "startup":startup,
    "takeupWater":takeupWater
  };
})();
world.observer.setGlobal("water-flow", 10);
world.observer.setGlobal("co2-amount", 14);
world.observer.setGlobal("sun-brightness", 36);
world.observer.setGlobal("day-night?", false);


procedures.myImportDrawing = function(src) {
  try {
    window.drawings.push(src);
  } catch(e) {
    if (typeof(console) !== 'undefined' && console && console.log) {
      console.log("Error adding src for myImportDrawing", src, e);
    }
  }
};
procedures['MY-IMPORT-DRAWING'] = procedures.myImportDrawing;
window.startup = procedures.startup;
      session.startLoop()
    </script>
<script src='jquery-1.11.3.min.js' type='text/javascript'></script>
<script src='shutterbug-0.5.4.js' type='text/javascript'></script>
<script>
  Shutterbug.enable('body');
</script>
  </body>
</html>
