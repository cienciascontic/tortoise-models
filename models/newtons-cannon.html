
<!-- saved from url=(0050)http://li425-91.members.linode.com:9000/save-nlogo -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="app.css" charset="utf-8"/>
<style>
  #output {
    position: absolute;
    left: 36px;
    top: 355px;
    border: 1px solid grey;
    width: 188px;
    height: 130px;
  }
</style>
  </head>
  <body>
    <div id="model-container"><div class="netlogo-model" style="width: 811;"><div class="netlogo-header"><label class="netlogo-widget netlogo-speed-slider"><span class="netlogo-label">speed</span> <input type="range" min="-1" max="1" step="0.01"></label> <div class="netlogo-powered-by"><a href="http://ccl.northwestern.edu/netlogo/"><img style="vertical-align: middle;" alt="NetLogo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANcSURBVHjarJRdaFxFFMd/M/dj7252uxubKms+bGprVyIVbNMWWqkQqtLUSpQWfSiV+oVFTcE3DeiDgvoiUSiCYLH2oVoLtQ+iaaIWWtE2FKGkkSrkq5svN+sm7ma/7p3x4W42lEbjQw8MM8yc87/nzPnNFVprbqWJXyMyXuMqx1Ni6N3ny3cX8tOHNLoBUMvESoFI2Xbs4zeO1lzREpSrMSNS1zkBDv6uo1/noz1H7mpvS4SjprAl2AZYEqzKbEowBAgBAkjPKX2599JjT7R0bj412D0JYNplPSBD1G2SmR/e6u1ikEHG2vYiGxoJmxAyIGSCI8GpCItKimtvl2JtfGujDNkX6epuAhCjNeAZxM1ocPy2Qh4toGQ5DLU+ysiuA2S3P0KgJkjAgEAlQylAA64CG/jlUk6//ng4cNWmLK0yOPNMnG99Rs9LQINVKrD+wmke7upg55PrWP3eYcwrlykpKCkoelDy/HVegQhoABNAepbACwjOt72gZkJhypX70YDWEEklue+rbnYc2MiGp1upPfYReiJJUUG58gFXu4udch1wHcjFIgy0HyIjb2yvBpT2F6t+6+f+D15lW8c9JDo7iPSdgVIRLUqL2AyHDQAOf9hfbqxvMF98eT3RuTS1avHyl+Stcphe2chP9+4k/t3RbXVl3W+Ws17FY56/w3VcbO/koS/eZLoAqrQMxADZMTYOfwpwoWjL4+bCYcgssMqGOzPD6CIkZ/3SxTJ0ayFIN6/BnBrZb2XdE1JUgkJWkfrUNRJnPyc16zsbgPyXIUJBpvc+y89nk/S8/4nek3NPGeBWMwzGvhUPnP6RubRLwfODlqqx3LSCyee2MnlwMwA2RwgO5qouVcHmksUdJweYyi8hZkrUjgT5t/ejNq0jBsSqNWsKyT9uFtxw7Bs585d3g46KOeT2bWHmtd14KyP+5mzqpsYU3OyioACMhGiqPTMocsrHId9cy9BLDzKxq8X3ctMwlV6yKSHL4fr4dd0DeQBTBUgUkvpE1kVPbqkX117ZzuSaFf4zyfz5n9A4lk0yNU7vyb7jTy1kmFGipejKvh6h9n0W995ZPTu227hqmCz33xXgFV1v9NzI96NfjndWt7XWCB/7BSICFWL+j3lAofpCtfYFb6X9MwCJZ07mUsXRGwAAAABJRU5ErkJggg=="> <span style="font-size: 16px;">powered by NetLogo</span></a></div></div> <div style="position: relative; width: 811; height: 466" class="netlogo-widget-container"><div class="netlogo-widget netlogo-view-container" style="position: absolute; left: 199px; top: 17px; width: 612px; height: 449px;"><div class="netlogo-widget netlogo-tick-counter">ticks: <span></span></div><div class="view-layers" style="width: 100%; position: relative;"><canvas width="1204" height="836" class="patch-view" style="width: 100%; z-index: 0;"></canvas><canvas width="1806" height="1254" class="turtle-view" style="width: 100%; position: absolute; top: 0px; left: 0px; z-index: 1;"></canvas><canvas width="602" height="418" class="spotlight-view" style="width: 100%; position: absolute; top: 0px; left: 0px; z-index: 2;"></canvas></div></div>              <label class="netlogo-widget netlogo-slider netlogo-input" style="position: absolute; left: 2px; top: 104px; width: 194px; height: 33px;"><input type="range" max="100" min="0" step="1"> <span class="netlogo-label">launchHeading</span> <span class="netlogo-value"><input type="number" min="0" max="100" step="1"> °</span></label>         <label class="netlogo-widget netlogo-slider netlogo-input" style="position: absolute; left: 2px; top: 170px; width: 194px; height: 33px;"><input type="range" max="1" min="-3.7" step=".05"> <span class="netlogo-label">MainScale</span> <span class="netlogo-value"><input type="number" min="-3.7" max="1" step=".05"> </span></label>        <label class="netlogo-widget netlogo-button netlogo-forever-button netlogo-active netlogo-command" style="position: absolute; left: 11px; top: 12px; width: 176px; height: 33px;"><input type="checkbox"> <span class="netlogo-label">Turn On before launching</span></label>        <button class="netlogo-widget netlogo-button netlogo-command" type="button" style="position: absolute; left: 18px; top: 62px; width: 80px; height: 33px;"><span>Launch!</span></button>           <label class="netlogo-widget netlogo-slider netlogo-input" style="position: absolute; left: 2px; top: 138px; width: 194px; height: 33px;"><input type="range" max="15" min="0" step=".1"> <span class="netlogo-label">LaunchSpeed</span> <span class="netlogo-value"><input type="number" min="0" max="15" step=".1"> km/s</span></label>           <div class="netlogo-widget netlogo-monitor netlogo-output" style="position: absolute; left: 5px; top: 219px; width: 87px; height: 45px;"><div class="netlogo-label">time (minutes)</div> <output class="netlogo-value">2.3</output></div>       <label class="netlogo-widget netlogo-slider netlogo-input" style="position: absolute; left: 379px; top: 10px; width: 247px; height: 33px;"><input type="range" max="1" min="-1" step=".05"> <span class="netlogo-label">Model_Speed</span> <span class="netlogo-value"><input type="number" min="-1" max="1" step=".05"> </span></label>           <div class="netlogo-widget netlogo-monitor netlogo-output" style="position: absolute; left: 93px; top: 220px; width: 104px; height: 45px;"><div class="netlogo-label">SSI Altitude (km)</div> <output class="netlogo-value">0</output></div>     <button class="netlogo-widget netlogo-button netlogo-command" type="button" style="position: absolute; left: 114px; top: 62px; width: 71px; height: 33px;"><span>Erase Dots</span></button>                  <button class="netlogo-widget netlogo-button netlogo-command" type="button" style="position: absolute; left: 57px; top: 433px; width: 101px; height: 33px;"><span>Clear Table</span></button>       <pre class="netlogo-widget netlogo-text-box" style="position: absolute; left: 7px; top: 283px; width: 188px; height: 28px;">Distance  Heading  Launch Speed</pre>       </div> <div class="netlogo-tabs"><label class="netlogo-code-tab netlogo-tab netlogo-command "><input type="checkbox"> NetLogo Code</label> <label class="netlogo-info-tab netlogo-tab netlogo-command "><input type="checkbox"> Model Info</label></div> <div class="netlogo-model-text"> </div></div></div>
    <div id="output" class="netlogo-text-box"></div>
    <script type="text/string" id="nlogo-code">
breed [mountains mountain]
breed [arrows arrow]
breed [ISSs ISS]       ;;ISS=International Space Station
breed [puffs puff]
breed [junkpiles junkpile]

puffs-own [x0 y0] ;; (x0,y0) are the coordinates of the puff relative to the earth's center.  
junkpiles-own [x1 y1 ] ;;(x1,y1) are the coordinates of the junkpile relative to the earth's center.  

Globals [scale eRadK gHP mOffP cycleCount rX rY rVX rVY rMass b1 b2 alive? Gm running? oldLS launchHeight montainHeight time nextPuffTime puffInterval]
;; scale is the overall scale used in the main view in patches per km--that is scale is the number of patches on the screen to km in the simulation
;; eRadK is the earth's radius in km
;; gHP is the ground height in patches, the hight of the mounain base above the bottom of the screen measured in patches
;; mOffP is the offset from the left edge of the main sceen of the base of the mountain (and the launch site) in patches
;; cycleCount is the number of times the computation has gone though the main look since start
;; rX is the x-coordinate of current location of the SSI (used to be a rocket) in km where the center of the Earth is (0,0)
;; ry is the y-coordinate ....
;; rVX is the current x-component of the velocity of the SSI in km/s
;; rVY is the y-component
;; rMass is the mass of the SSI
;; b1-b2 are the offsets of the x and y coordinate origins for the screen. Hence scale * x + b1 is the screen location in patches of x measured in km
;; alive? is a logical that is true between launch and crash
;; Gm is the universal gravitational constant G times the mass of the earth
;; running? is a logical that is true between launch and crash if the simulation is not paused. 
;; oldLS stores the old value of the LS the log of the scale. Used to make the scale slider always active
;; oldIScale ditto for the insert scale slider
;; launchHeight stores the height of the launch
;; time is the elapsed time since launch in sec
;; nextPuffTime stores the time when the next puff will be emitted
;; puffInterval is the time between puffs in sec

to startup
  initialize
  run_simulation
end

to Run_Simulation                     ;; executed repeatedly when the 'Run Simulation' button is pressed
  if cycleCount = 0                   ;; cycleCount is a global variable that is zero when NetLogo is first started
     [initialize ]                    ;; only on the first time through, initialize all the globals and create turtles. 
  if running?                         ;; 'running?" is a logical that is true after firing the ISS until paused or crashed
     [stepISS                      ;; if running? is true then move the ISS    
        set cyclecount cyclecount + 1 ]      ;; cycleCount counts the number of steps executed              
  every .2 [updateUI ]                           ;; monitor the user interface every .2 second
end

to updateUI                           ;; this adjusts scene for changes in arrows, scales, and mountain height
  if not (oldLS = MainScale)           ;; check for a change in the MainScale slider
     [drawScene set oldLS MainScale ]  ;; redraw the entire scene if the scale is changed. Remember the current setting  
  placeArrows                       ;; in the future, this might also respond to other changes in the UI
  handlePuffs
end

to reset                            ;; this is handy for debugging, but shouldn't be necessary in the production version
  set Cyclecount 0
  cp ct                           ;; clear patches and turtles
end

to initialize
  set time 0
  set CycleCount 1               ;; this ensures that initialize is execued only once
  set running? false             ;; start in the non running mode
  set alive? false               ;; start with the ISS not alive 
  set eRadK 6378                 ;; earth radius in km
  set rVX 0                      ;; the initial ISS x-velocity (km/s)
  set rVY 0                      ;; the initial ISS y-velocity
  set rX 0                       ;; the initial ISS x-position relative to the earth center (km)
  set rY eRadK + LaunchHeight    ;; the initial ISS y-position in km
  set rMass 3.44e5                  ;; the ISS mass in kg
  ;; note there are additional globals created in the UI
  set montainHeight  8.8            ;; the height of the mountain in km
  set launchHeight  8.8              ;; the height of the launching arrow in km
  set Gm 398600                  ;; the universal gravitational constant times the mass of the earth in km-kg-sec system
  create-ISSs 1 [set size 0 set shape "ISS" ]  ;; the ISS will show up in the main scene and the insert
  create-arrows 1 [set size 0 set shape "arrow" set color red ]
  create-mountains 1 [set shape "mountain" set heading 0]
  drawScene
end

to placeArrows ;; keep the arrows up-to-date with changes in the sliders
  ask arrows [
    set heading launchHeading ;; aim it in the right direction
    let xx min-pxcor + mOffP
    let yy min-pycor + gHP + scale * launchHeight
    ifelse yy < max-pycor [setxy xx yy set size 15 ] [set size 0]]
end

to launch  ; move the ISS to the launcher and give it an initial velocity
  set rVX launchSpeed * sin launchHeading
  set rVY launchSpeed * cos launchHeading
  set rX 0                       ;; the initial location of the ISS is at the origin of the x-axis, directly above the center of the earth
  set rY eRadK + LaunchHeight    ;; the y-coordinate is the radius of the earth plus the launch height in km.
  set alive? true                ;; turn on the ISS. 
  set running? true   
  set time 0                     ;; times the launch
  set nextPuffTime 0  handlePuffs           ;; create a puff
  set puffInterval .04 * max-pxcor / (scale * launchSpeed) ;; sets 50 puffs across screen given launch speed
end

to stepISS
  ;; move the ISS forward one dt step. All calcuations done in KMKS system. 
  let dt 10 ^ Model_Speed       ;; Model Speed is set by a slider
  let xx rx + rvx * dt / 2      ;; move forward a half-step to (xx,yy) (local variables)
  let yy ry + rvy * dt / 2
  let r2 xx ^ 2 + yy ^ 2        ;; compute the square of the distance to the center of the earth
  let r sqrt r2                 ;; compute the distance to the center of the earth at this half-step location
  set time time + dt
  ifelse  r > eRadK 
    [ let r3 r * r2             ;; compute r-cubed
      let ax 0 -  Gm * xx / r3   ;; use the force at the mid-point to determine the acceleration
      let ay 0 -  Gm * yy / r3  ;; a-vector = -G*me*r-vector / r-magnitude^3
      set rvx rvx + ax * dt     ;; use the acceleration to change the velocity
      set rvy rvy + ay * dt
      set rx rx + rvx * dt      ;; use the velocity to change the position
      set ry ry + rvy * dt
      placeISS              ;; show the ISSs if they are visible
      handlePuffs]              ;; make and remove puffs 
   [showresults                 ;; type results into output box
     explode ]                   ;; if the ISS collides with the earth, explode
end

to showresults
  let r eRadK * 2 * pi * (atan rx ry) / 360  ;; distance on surface of earth from launch
  my-output-type round r
  my-output-type "km   "
  my-output-type launchHeading
  my-output-type "°   "
  my-output-type launchSpeed
  my-output-print "km/s"
end

to handlePuffs
  if time > nextPuffTime [           ;; if it is time for a new puff...
    create-puffs 1 [                 ;; create a new puff
      set nextPuffTime nextPuffTime + puffInterval  ;; set the time for the next puff
      set x0 rx                      ;; the location of this puff is taken from the current ISS location
      set y0 ry
      set shape "circle"
      set color red
      let temp main x0 y0           ;; compute the screen position of each puff
      ifelse last temp              ;; last item in temp is a logical that tells whether this puff is in the main screen. 
         [setxy first temp item 1 temp     ;; if it is on-screen update the location of the puff
           set size 2 ]
         [set size 0]]]                ;; if outside the main scene make it vanish but don't kill it.
end
  
to placePuffs     
    ask puffs [
       let temp main x0 y0           ;; compute the screen position of each puff
       ifelse last temp              ;; last item in temp is a logical that tells whether this puff is in the main screen. 
         [setxy first temp item 1 temp     ;; if it is on-screen update the location of the puff
           set size 2 ]
         [set size 0]]                ;; if outside the main scene make it vanish but don't kill it--yet
end

to placeISS   ;; show the ISS at its location rx,ry if visible
   if alive? 
     [ask ISSs [
     set heading atan rvx rvy 
                       ;; if it is visible in the main scene, show it
     let temp main rx ry          ;; temp contains the screen coordinates of rx,ry (items 0 and 1) and whether this is visible (item 2)
       ifelse last temp             ;; if the ISS is visible in the main screen.........
           [setxy first temp item 1 temp           ;; update the location of the ISS
               set size 16 ]        ;; turn it on in case it has been off
           [set size 0 ]         ;; turn if off if it is outside the main scene
     ]]
end

to placeJunk       ;; show the junkpiles that are visible
  ask junkpiles [
    let temp main x1 y1          ;; convert the earth coordinates to screen coordinates. 
    ifelse last temp             ;; if this point is visible on the main screen...
      [setxy first temp item 1 temp set size 16 ]  ;;place it and turn it on
      [set size 0]               ;; otherwise turn it off
  ]
end

to-report main [u v]             ;; checks whether the location u,v in earth coordinates is visible in the main scene.
   let x scale * u + b1          ;; transform u,v to screen coordinates
                                 ;; returns the screen coordinates and a logical telling whether it is currently visible.
   let y scale * v + b2          ;; (x,y) are the patch locations of the ISS relative to the center of the scene
                                 ;; first check to see whether it the point is inside the main scene
   ifelse  x < max-pxcor and x > min-pxcor and y < max-pycor and y > min-pycor 
         [report (list x y true)]
         [report (list x y false)]                ;; return false if it is outside the main screen
end

to explode
    let sz 10
    ask ISSs [set shape "explosion"]  ;; turn ISSs into explosions
    repeat 20 [                          ;; slowly increase the size of each for 50 steps of .1 sec each
       ask ISSs [if size > 0 [set size sz ]]
       set sz sz + 2.2
       pause .1 ]      
   ask ISSs [set size 0 set shape "ISS"]  ;; turn them back into ISSs
   create-junkpiles 1                      ;; create a junkpile where the ISS crashes
     [set shape "junk" 
     set color white 
     set heading atan rx ry                ;; its heading is away from the center of the earth
     set x1 rx                             ;; give it the currnet coordinates of the ISS. 
     set y1 ry]
   placeJunk  ;; shows all the junkpiles, including the last
   set running? false                    ;; after colliding with the earth, pause the integration engine
   set alive? false                      ;; after colliding with the earth, the ISS is not alive
   ;; the difference between running? and alive? is that a ISS may be alive but paused, not running
end

to drawScene  ;; Draws everything--updates the screen
  ;; first some parameters for the main drawing
  ;; scale is a global, the number of patchs per km in the main scene -- the main scaling number
  set scale  10 ^ MainScale       ;; scale is the number of patchs per km in the main scene--the slider is logarithmic
  let v 1  
  if MainScale > -3 
    [set v (1 - MainScale ) / 4 ] ;; goes from 0 to 1 as the MainScale goes from 1 to -3. Stop moving earth when MainScale gets below -3 
  set gHP 10 + max-pycor * v     ;; height of the ground above bottom of the main scene, in patchs. Moves up for smaller scales
  set mOffP 90 + (max-pxcor - 100) * v      ;; mountain offset from left of scene, in patchs. Moves to center for smaller scales
  set b1 mOffP + min-pxcor       ;; the constant in the conversion of x to patchs in the main scene
  set b2 gHP + min-pycor - scale * eRadK ;; the constant in the conversion of y to patchs in the main scene
  ;; the conversion is (h,v) in patchs in the main scene = (scale*x + b1, scale*y + b2) where x,y are in km relative to the earth center
  let TropoTop 10 ;; the top of the tropospehere in km above the earth's surface
  let StratoTop 50 ;; the top of the stratosphere in km above the earth's surface
  let earthTopP min-pycor + gHP ;; the top of the earth in the main scene in patchs 
  let mountainSizeP montainHeight * scale ;; measured in patchs
  let mountainX min-pxcor + mOffP ;; locates the x-center of the mountain

  ;; Begin the drawing
  cp ;; clear all the patches--sets them to black
  ask patches [
    let x (pxcor - b1) / scale                     ;; x-coordinate of patch relative to earth's center
    let y (pycor - b2) / scale                     ;; y-coordinate of patch relative to earth's center
    let alt sqrt (x ^ 2 + y ^ 2 ) - eRadK          ;; altitude of patch above earth in km
    ifelse alt + .6 * eRadK < 0 [set pcolor white] ;; a polar cap 
      [ifelse alt < 0 
       [ ifelse y < 0 [ set pcolor blue ][ set pcolor green ]]    ;; if altitude is negative, make green or blue depending on the side of the earth
         [ifelse alt < tropoTop [set pcolor 108 ]  ;; otherwise if the altitude is less than the troposphere, make blue sky
          [if alt < StratoTop                      ;; if it is below the stratosphere...
            [set pcolor 100 + 8 * (StratoTop - alt) / (StratoTop - TropoTop )]]]]]  ;; fade to black
  ask mountains [                                  ;; create one mountain
    setxy mountainX earthTopP + ( mountainSizeP / 2  - 1) ;; center the mountain just below half its diameter above the earth
    set size mountainSizeP ]
  placeArrows                                      ;; put the arrows in their new position
  placeISS 
  placePuffs
  placeJunk
end

to my-output-type [string]
  ;; output-type string
end

to my-output-print [string]
  ;; output-print string
end

to my-clear-output
  ;; clear-output
end

to pause [t]
  ;; wait t
end</script>
    <script type="text/string" id="nlogo-info">## WHAT IS IT?

This section could give a general understanding of what the model is trying to show or explain.

## HOW IT WORKS

This section could explain what rules the agents use to create the overall behavior of the model.

## HOW TO USE IT

This section could explain how to use the model, including a description of each of the items in the interface tab.

## THINGS TO NOTICE

This section could give some ideas of things for the user to notice while running the model.

## THINGS TO TRY

This section could give some ideas of things for the user to try to do (move sliders, switches, etc.) with the model.

## EXTENDING THE MODEL

This section could give some ideas of things to add or change in the procedures tab to make the model more complicated, detailed, accurate, etc.

## NETLOGO FEATURES

This section could point out any especially interesting or unusual features of NetLogo that the model makes use of, particularly in the Procedures tab.  It might also point out places where workarounds were needed because of missing features.

## RELATED MODELS

This section could give the names of models in the NetLogo Models Library or elsewhere which are of related interest.

## CREDITS AND REFERENCES

This section could contain a reference to the model's URL on the web if it has one, as well as any other necessary credits or references.</script>
<script type="text/javascript" src="app.js"></script>
    <script type="text/javascript">
;

      var widgets = [{"left":199,"top":17,"right":811,"bottom":466,"patchSize":2.0,"fontSize":10,"wrappingAllowedInX":true,"wrappingAllowedInY":true,"minPxcor":-150,"maxPxcor":150,"minPycor":-104,"maxPycor":104,"updateMode":"Continuous","showTickCounter":true,"tickCounterLabel":"ticks","frameRate":30.0,"type":"view"},{"display":"launchHeading","left":2,"top":104,"right":196,"bottom":137,"varName":"launchHeading","min":"0","max":"100","default":20.0,"step":"1","units":"°","direction":"horizontal","type":"slider","compiledMin":{"success":true,"result":"0"},"compiledMax":{"success":true,"result":"100"},"compiledStep":{"success":true,"result":"1"}},{"display":"MainScale","left":2,"top":170,"right":196,"bottom":203,"varName":"MainScale","min":"-3.7","max":"1","default":1.0,"step":".05","units":null,"direction":"horizontal","type":"slider","compiledMin":{"success":true,"result":"-3.7"},"compiledMax":{"success":true,"result":"1"},"compiledStep":{"success":true,"result":"0.05"}},{"display":"Turn On before launching","left":11,"top":12,"right":187,"bottom":45,"source":"Run_Simulation","forever":true,"buttonType":"OBSERVER","actionKey":null,"type":"button","compiledSource":{"success":true,"result":"Call(run_simulation);"}},{"display":"Launch!","left":18,"top":62,"right":98,"bottom":95,"source":"Launch","forever":false,"buttonType":"OBSERVER","actionKey":null,"type":"button","compiledSource":{"success":true,"result":"Call(launch);"}},{"display":"LaunchSpeed","left":2,"top":138,"right":196,"bottom":171,"varName":"LaunchSpeed","min":"0","max":"15","default":0.3,"step":".1","units":"km/s","direction":"horizontal","type":"slider","compiledMin":{"success":true,"result":"0"},"compiledMax":{"success":true,"result":"15"},"compiledStep":{"success":true,"result":"0.1"}},{"display":"time (minutes)","left":5,"top":219,"right":92,"bottom":264,"source":"time / 60","precision":1,"fontSize":11,"type":"monitor","compiledSource":{"success":true,"result":"(world.observer.getGlobal('time') / 60)"}},{"display":"Model_Speed","left":379,"top":10,"right":626,"bottom":43,"varName":"Model_Speed","min":"-1.0","max":"1.0","default":0.0,"step":".05","units":null,"direction":"horizontal","type":"slider","compiledMin":{"success":true,"result":"-1"},"compiledMax":{"success":true,"result":"1"},"compiledStep":{"success":true,"result":"0.05"}},{"display":"SSI Altitude (km)","left":93,"top":220,"right":197,"bottom":265,"source":"round (sqrt (Rx ^ 2 + ry ^ 2) - eRadK)","precision":1,"fontSize":11,"type":"monitor","compiledSource":{"success":true,"result":"StrictMath.round((StrictMath.sqrt((StrictMath.pow(world.observer.getGlobal('rx'), 2) + StrictMath.pow(world.observer.getGlobal('ry'), 2))) - world.observer.getGlobal('eradk')))"}},{"display":"Erase Dots","left":114,"top":62,"right":185,"bottom":95,"source":"ask puffs [die]\\nask junkpiles [die]","forever":false,"buttonType":"OBSERVER","actionKey":null,"type":"button","compiledSource":{"success":true,"result":"world.turtleManager.turtlesOfBreed(\"PUFFS\").ask(function() {\n  SelfPrims.die();\n}, true);\nworld.turtleManager.turtlesOfBreed(\"JUNKPILES\").ask(function() {\n  SelfPrims.die();\n}, true);"}},{"left":7,"top":298,"right":199,"bottom":431,"fontSize":12,"type":"output"},{"display":"Clear Table","left":57,"top":433,"right":158,"bottom":466,"source":"my-clear-output","forever":false,"buttonType":"OBSERVER","actionKey":null,"type":"button","compiledSource":{"success":true,"result":"Call(myClearOutput);"}},{"display":"Distance  Heading  Launch Speed","left":7,"top":283,"right":195,"bottom":311,"fontSize":11,"color":0.0,"transparent":true,"type":"textBox"}];
      var code    = document.querySelector("#nlogo-code").textContent;
      var info    = document.querySelector("#nlogo-info").textContent;
      var session = Tortoise.fromCompiledModel('#model-container', widgets, code, info, '', true);
      var modelConfig  = (typeof window.modelConfig !== "undefined" && window.modelConfig !== null) ? window.modelConfig : {};
var modelPlotOps = (typeof modelConfig.plotOps !== "undefined" && modelConfig.plotOps !== null) ? modelConfig.plotOps : {};

var PenBundle = tortoise_require('engine/plot/pen');
var Plot      = tortoise_require('engine/plot/plot');
var PlotOps   = tortoise_require('engine/plot/plotops');

modelConfig.plots = [];

var workspace = tortoise_require('engine/workspace')(modelConfig)([{ name: 'MOUNTAINS', singular: 'mountain', varNames: [] }, { name: 'ARROWS', singular: 'arrow', varNames: [] }, { name: 'ISSS', singular: 'iss', varNames: [] }, { name: 'PUFFS', singular: 'puff', varNames: ['x0', 'y0'] }, { name: 'JUNKPILES', singular: 'junkpile', varNames: ['x1', 'y1'] }])([], [])(['launchheading', 'mainscale', 'launchspeed', 'model_speed', 'scale', 'eradk', 'ghp', 'moffp', 'cyclecount', 'rx', 'ry', 'rvx', 'rvy', 'rmass', 'b1', 'b2', 'alive?', 'gm', 'running?', 'oldls', 'launchheight', 'montainheight', 'time', 'nextpufftime', 'puffinterval'], ['launchheading', 'mainscale', 'launchspeed', 'model_speed'], [], -150, 150, -104, 104, 2.0, true, true, {"default":{"rotate":true,"elements":[{"xcors":[150,40,150,260],"ycors":[5,250,205,250],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"airplane":{"rotate":true,"elements":[{"xcors":[150,135,120,120,15,15,120,135,105,120,150,180,210,165,180,285,285,180,180,165],"ycors":[0,15,60,105,165,195,180,240,270,285,270,285,270,240,180,195,165,105,60,15],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"arrow":{"rotate":true,"elements":[{"xcors":[150,0,105,105,195,195,300],"ycors":[0,150,150,293,293,150,150],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"box":{"rotate":false,"elements":[{"xcors":[150,285,285,150],"ycors":[285,225,75,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[150,15,150,285],"ycors":[135,75,15,75],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[15,15,150,150],"ycors":[75,225,285,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":150,"y1":285,"x2":150,"y2":135,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x1":150,"y1":135,"x2":15,"y2":75,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x1":150,"y1":135,"x2":285,"y2":75,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false}]},"bug":{"rotate":true,"elements":[{"x":96,"y":182,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":110,"y":127,"diam":80,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":110,"y":75,"diam":80,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":150,"y1":100,"x2":80,"y2":30,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":150,"y1":100,"x2":220,"y2":30,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"butterfly":{"rotate":true,"elements":[{"xcors":[150,209,225,225,195,165,150],"ycors":[165,199,225,255,270,255,240],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[150,89,75,75,105,135,150],"ycors":[165,198,225,255,270,255,240],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[139,100,55,25,10,10,25,40,85,139],"ycors":[148,105,90,90,105,135,180,195,194,163],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[162,200,245,275,290,290,275,260,215,162],"ycors":[150,105,90,90,105,135,180,195,195,165],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[150,135,120,135,150,165,180,165],"ycors":[255,225,150,120,105,120,150,225],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":135,"y":90,"diam":30,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x1":150,"y1":105,"x2":195,"y2":60,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x1":150,"y1":105,"x2":105,"y2":60,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false}]},"car":{"rotate":false,"elements":[{"xcors":[300,279,261,240,226,213,203,185,159,135,75,0,0,0,300,300],"ycors":[180,164,144,135,132,106,84,63,50,50,60,150,165,225,225,180],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":180,"y":180,"diam":90,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":30,"y":180,"diam":90,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[162,132,134,209,194,189,180],"ycors":[80,78,135,135,105,96,89],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":47,"y":195,"diam":58,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":195,"y":195,"diam":58,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"circle":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"circle 2":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":30,"y":30,"diam":240,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"cow":{"rotate":false,"elements":[{"xcors":[200,197,179,177,166,140,93,78,72,49,48,37,25,25,45,103,179,198,252,272,293,285,255,242,224],"ycors":[193,249,249,196,187,189,191,179,211,209,181,149,120,89,72,84,75,76,64,81,103,121,121,118,167],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[73,86,62,48],"ycors":[210,251,249,208],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[25,16,9,23,25,39],"ycors":[114,195,204,213,200,123],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"cylinder":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"dot":{"rotate":false,"elements":[{"x":90,"y":90,"diam":120,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"earth":{"rotate":true,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":96,"y":96,"diam":108,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[45,75,75,120,135,195,225,240,270,255,240,240,210,165,120,90,60],"ycors":[45,60,75,75,60,75,105,135,120,90,60,30,15,0,0,15,30],"type":"polygon","color":"rgba(29, 159, 120, 1.0)","filled":true,"marked":false},{"xcors":[75,45,30,30,15,0,0,0,30,60,105,135,150,150,120,90,75,60,60,75],"ycors":[135,105,105,135,135,120,150,180,240,270,285,270,240,210,210,195,165,165,150,135],"type":"polygon","color":"rgba(29, 159, 120, 1.0)","filled":true,"marked":false}]},"explosion":{"rotate":true,"elements":[{"xcors":[90,15,90,75,150,90,150,180,165,240,180,270,150,165,135,75,90],"ycors":[150,135,135,105,135,30,90,15,120,105,135,195,150,210,165,255,150],"type":"polygon","color":"rgba(237, 237, 49, 1.0)","filled":true,"marked":false},{"xcors":[120,75,105,60,120,30,120,150,150,240,195,270,180,210,150,135],"ycors":[90,75,105,120,150,195,165,285,165,240,165,120,120,45,90,30],"type":"polygon","color":"rgba(215, 50, 41, 1.0)","filled":true,"marked":false}]},"face happy":{"rotate":false,"elements":[{"x":8,"y":8,"diam":285,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":60,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":180,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[150,90,62,47,67,90,109,150,192,210,227,251,236,212],"ycors":[255,239,213,191,179,203,218,225,218,203,181,194,217,240],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"face neutral":{"rotate":false,"elements":[{"x":8,"y":7,"diam":285,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":60,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":180,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":60,"ymin":195,"xmax":240,"ymax":225,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"face sad":{"rotate":false,"elements":[{"x":8,"y":8,"diam":285,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":60,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":180,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[150,90,62,47,67,90,109,150,192,210,227,251,236,212],"ycors":[168,184,210,232,244,220,205,198,205,220,242,229,206,183],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"fish":{"rotate":false,"elements":[{"xcors":[44,21,15,0,15,0,13,20,45],"ycors":[131,87,86,120,150,180,214,212,166],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[135,119,95,76,46,60],"ycors":[195,235,218,210,204,165],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[75,83,71,86,166,135],"ycors":[45,77,103,114,78,60],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[30,151,226,280,292,292,287,270,195,151,30],"ycors":[136,77,81,119,146,160,170,195,210,212,166],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":215,"y":106,"diam":30,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"flag":{"rotate":false,"elements":[{"xmin":60,"ymin":15,"xmax":75,"ymax":300,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[90,270,90],"ycors":[150,90,30],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":75,"y1":135,"x2":90,"y2":135,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":75,"y1":45,"x2":90,"y2":45,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"flower":{"rotate":false,"elements":[{"xcors":[135,165,180,180,150,165,195,195,165],"ycors":[120,165,210,240,300,300,240,195,135],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"x":85,"y":132,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":130,"y":147,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":192,"y":85,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":85,"y":40,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":177,"y":40,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":177,"y":132,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":70,"y":85,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":130,"y":25,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":96,"y":51,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":113,"y":68,"diam":74,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[189,219,249,279,234],"ycors":[233,188,173,188,218],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[180,150,105,75,135],"ycors":[255,210,210,240,240],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false}]},"house":{"rotate":false,"elements":[{"xmin":45,"ymin":120,"xmax":255,"ymax":285,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":120,"ymin":210,"xmax":180,"ymax":285,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[15,150,285],"ycors":[120,15,120],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":30,"y1":120,"x2":270,"y2":120,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false}]},"iss":{"rotate":true,"elements":[{"xmin":120,"ymin":45,"xmax":180,"ymax":255,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[120,150,180],"ycors":[45,0,45],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"x":135,"y":255,"diam":30,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xmin":0,"ymin":135,"xmax":300,"ymax":150,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xmin":30,"ymin":45,"xmax":45,"ymax":240,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xmin":60,"ymin":45,"xmax":75,"ymax":240,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xmin":225,"ymin":45,"xmax":240,"ymax":240,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xmin":255,"ymin":45,"xmax":270,"ymax":240,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false}]},"junk":{"rotate":true,"elements":[{"xcors":[60,240,180,210,180,180,165,150,135,105,60,90],"ycors":[150,150,135,90,75,15,15,105,90,45,90,120],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false}]},"leaf":{"rotate":false,"elements":[{"xcors":[150,135,120,60,30,60,60,15,30,15,40,45,60,90,105,120,105,120,135,150,165,180,195,180,195,210,240,255,263,285,270,285,240,240,270,240,180,165],"ycors":[210,195,210,210,195,180,165,135,120,105,104,90,90,105,120,120,60,60,30,15,30,60,60,120,120,105,90,90,104,105,120,135,165,180,195,210,210,195],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,135,120,105,105,135,165,165],"ycors":[195,240,255,255,285,285,240,195],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"line":{"rotate":true,"elements":[{"x1":150,"y1":0,"x2":150,"y2":300,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"line half":{"rotate":true,"elements":[{"x1":150,"y1":0,"x2":150,"y2":150,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"mountain":{"rotate":true,"elements":[{"xcors":[0,120,180,300],"ycors":[300,15,15,300],"type":"polygon","color":"rgba(157, 110, 72, 1.0)","filled":true,"marked":false},{"xcors":[120,60,105,105,135,165,165,195,195,180,120],"ycors":[15,165,105,135,45,180,105,150,60,15,15],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false}]},"pentagon":{"rotate":false,"elements":[{"xcors":[150,15,60,240,285],"ycors":[15,120,285,285,120],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"person":{"rotate":false,"elements":[{"x":110,"y":5,"diam":80,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[105,120,90,105,135,150,165,195,210,180,195],"ycors":[90,195,285,300,300,225,300,300,285,195,90],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":127,"ymin":79,"xmax":172,"ymax":94,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[195,240,225,165],"ycors":[90,150,180,105],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[105,60,75,135],"ycors":[90,150,180,105],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"plant":{"rotate":false,"elements":[{"xmin":135,"ymin":90,"xmax":165,"ymax":300,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,90,45,75,135],"ycors":[255,210,195,255,285],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[165,210,255,225,165],"ycors":[255,210,195,255,285],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,90,45,75,135],"ycors":[180,135,120,180,210],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[165,165,225,255,210],"ycors":[180,210,180,120,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,90,45,75,135],"ycors":[105,60,45,105,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[165,165,225,255,210],"ycors":[105,135,105,45,60],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,120,150,180,165],"ycors":[90,45,15,45,90],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"rocket":{"rotate":true,"elements":[{"xcors":[120,75,135,165,225,180],"ycors":[165,285,255,255,285,165],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,105,105,120,135,150,165,180,195,195,165],"ycors":[285,135,105,45,15,0,15,45,105,135,285],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xmin":147,"ymin":176,"xmax":153,"ymax":288,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[120,180,165,150,135],"ycors":[45,45,15,0,15],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":105,"y1":105,"x2":135,"y2":120,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":135,"y1":120,"x2":165,"y2":120,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":165,"y1":120,"x2":195,"y2":105,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":105,"y1":135,"x2":135,"y2":150,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":135,"y1":150,"x2":165,"y2":150,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":165,"y1":150,"x2":195,"y2":135,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"square":{"rotate":false,"elements":[{"xmin":30,"ymin":30,"xmax":270,"ymax":270,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"square 2":{"rotate":false,"elements":[{"xmin":30,"ymin":30,"xmax":270,"ymax":270,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":60,"ymin":60,"xmax":240,"ymax":240,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"star":{"rotate":false,"elements":[{"xcors":[151,185,298,207,242,151,59,94,3,116],"ycors":[1,108,108,175,282,216,282,175,108,108],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"target":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":30,"y":30,"diam":240,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":60,"y":60,"diam":180,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":90,"y":90,"diam":120,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":120,"y":120,"diam":60,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"tree":{"rotate":false,"elements":[{"x":118,"y":3,"diam":94,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":120,"ymin":195,"xmax":180,"ymax":300,"type":"rectangle","color":"rgba(157, 110, 72, 1.0)","filled":true,"marked":false},{"x":65,"y":21,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":116,"y":41,"diam":127,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":45,"y":90,"diam":120,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":104,"y":74,"diam":152,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"triangle":{"rotate":false,"elements":[{"xcors":[150,15,285],"ycors":[30,255,255],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"triangle 2":{"rotate":false,"elements":[{"xcors":[150,15,285],"ycors":[30,255,255],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[151,225,75],"ycors":[99,223,224],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"truck":{"rotate":false,"elements":[{"xmin":4,"ymin":45,"xmax":195,"ymax":187,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[296,296,259,244,208,207],"ycors":[193,150,134,104,104,194],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":195,"ymin":60,"xmax":195,"ymax":105,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[238,252,219,218],"ycors":[112,141,141,112],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":234,"y":174,"diam":42,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":181,"ymin":185,"xmax":214,"ymax":194,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":144,"y":174,"diam":42,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":24,"y":174,"diam":42,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":24,"y":174,"diam":42,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":144,"y":174,"diam":42,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":234,"y":174,"diam":42,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"turtle":{"rotate":true,"elements":[{"xcors":[215,240,246,228,215,193],"ycors":[204,233,254,266,252,210],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[195,225,245,260,269,261,240,225,210],"ycors":[90,75,75,89,108,124,105,105,105],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[105,75,55,40,31,39,60,75,90],"ycors":[90,75,75,89,108,124,105,105,105],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[132,134,107,108,150,192,192,169,172],"ycors":[85,64,51,17,2,18,52,65,87],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[85,60,54,72,85,107],"ycors":[204,233,254,266,252,210],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[119,179,209,224,220,175,128,81,74,88],"ycors":[75,75,101,135,225,261,261,224,135,99],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"wheel":{"rotate":false,"elements":[{"x":3,"y":3,"diam":294,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":30,"y":30,"diam":240,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x1":150,"y1":285,"x2":150,"y2":15,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":15,"y1":150,"x2":285,"y2":150,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":120,"y":120,"diam":60,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":216,"y1":40,"x2":79,"y2":269,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":40,"y1":84,"x2":269,"y2":221,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":40,"y1":216,"x2":269,"y2":79,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":84,"y1":40,"x2":221,"y2":269,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"x":{"rotate":false,"elements":[{"xcors":[270,225,30,75],"ycors":[75,30,225,270],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[30,75,270,225],"ycors":[75,30,225,270],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]}}, {"default":{}});

var BreedManager  = workspace.breedManager;
var LayoutManager = workspace.layoutManager;
var LinkPrims     = workspace.linkPrims;
var ListPrims     = workspace.listPrims;
var MousePrims    = workspace.mousePrims;
var plotManager   = workspace.plotManager;
var Prims         = workspace.prims;
var SelfPrims     = workspace.selfPrims;
var SelfManager   = workspace.selfManager;
var Updater       = workspace.updater;
var world         = workspace.world;

var Call           = tortoise_require('util/call');
var ColorModel     = tortoise_require('util/colormodel');
var Exception      = tortoise_require('util/exception');
var Trig           = tortoise_require('util/trig');
var Type           = tortoise_require('util/typechecker');
var notImplemented = tortoise_require('util/notimplemented');

var Dump      = tortoise_require('engine/dump');
var Link      = tortoise_require('engine/core/link');
var LinkSet   = tortoise_require('engine/core/linkset');
var Nobody    = tortoise_require('engine/core/nobody');
var PatchSet  = tortoise_require('engine/core/patchset');
var Turtle    = tortoise_require('engine/core/turtle');
var TurtleSet = tortoise_require('engine/core/turtleset');
var Tasks     = tortoise_require('engine/prim/tasks');

var AgentModel = tortoise_require('agentmodel');
var Denuller   = tortoise_require('nashorn/denuller');
var Random     = tortoise_require('shim/random');
var StrictMath = tortoise_require('shim/strictmath');
function startup() {
  Call(initialize);
  Call(run_simulation);
}
function run_simulation() {
  if (Prims.equality(world.observer.getGlobal('cyclecount'), 0)) {
    Call(initialize);
  }
  if (world.observer.getGlobal('running?')) {
    Call(stepiss);
    world.observer.setGlobal('cyclecount', (world.observer.getGlobal('cyclecount') + 1));
  }
  Prims.every(0.2, function() {
    Call(updateui);
  }, 'run_simulation-0');
}
function updateui() {
  if (!Prims.equality(world.observer.getGlobal('oldls'), world.observer.getGlobal('mainscale'))) {
    Call(drawscene);
    world.observer.setGlobal('oldls', world.observer.getGlobal('mainscale'));
  }
  Call(placearrows);
  Call(handlepuffs);
}
function reset() {
  world.observer.setGlobal('cyclecount', 0);
  world.clearPatches();
  world.turtleManager.clearTurtles();
}
function initialize() {
  world.observer.setGlobal('time', 0);
  world.observer.setGlobal('cyclecount', 1);
  world.observer.setGlobal('running?', false);
  world.observer.setGlobal('alive?', false);
  world.observer.setGlobal('eradk', 6378);
  world.observer.setGlobal('rvx', 0);
  world.observer.setGlobal('rvy', 0);
  world.observer.setGlobal('rx', 0);
  world.observer.setGlobal('ry', (world.observer.getGlobal('eradk') + world.observer.getGlobal('launchheight')));
  world.observer.setGlobal('rmass', 344000);
  world.observer.setGlobal('montainheight', 8.8);
  world.observer.setGlobal('launchheight', 8.8);
  world.observer.setGlobal('gm', 398600);
  world.turtleManager.createTurtles(1, 'ISSS').ask(function() {
    SelfPrims.setVariable('size', 0);
    SelfPrims.setVariable('shape', "ISS");
  }, true);
  world.turtleManager.createTurtles(1, 'ARROWS').ask(function() {
    SelfPrims.setVariable('size', 0);
    SelfPrims.setVariable('shape', "arrow");
    SelfPrims.setVariable('color', 15);
  }, true);
  world.turtleManager.createTurtles(1, 'MOUNTAINS').ask(function() {
    SelfPrims.setVariable('shape', "mountain");
    SelfPrims.setVariable('heading', 0);
  }, true);
  Call(drawscene);
}
function placearrows() {
  world.turtleManager.turtlesOfBreed("ARROWS").ask(function() {
    SelfPrims.setVariable('heading', world.observer.getGlobal('launchheading'));
    var xx = (world.topology.minPxcor + world.observer.getGlobal('moffp'));
    var yy = ((world.topology.minPycor + world.observer.getGlobal('ghp')) + (world.observer.getGlobal('scale') * world.observer.getGlobal('launchheight')));
    if (Prims.lt(yy, world.topology.maxPycor)) {
      SelfPrims.setXY(xx, yy);
      SelfPrims.setVariable('size', 15);
    }
    else {
      SelfPrims.setVariable('size', 0);
    }
  }, true);
}
function launch() {
  world.observer.setGlobal('rvx', (world.observer.getGlobal('launchspeed') * Trig.unsquashedSin(world.observer.getGlobal('launchheading'))));
  world.observer.setGlobal('rvy', (world.observer.getGlobal('launchspeed') * Trig.unsquashedCos(world.observer.getGlobal('launchheading'))));
  world.observer.setGlobal('rx', 0);
  world.observer.setGlobal('ry', (world.observer.getGlobal('eradk') + world.observer.getGlobal('launchheight')));
  world.observer.setGlobal('alive?', true);
  world.observer.setGlobal('running?', true);
  world.observer.setGlobal('time', 0);
  world.observer.setGlobal('nextpufftime', 0);
  Call(handlepuffs);
  world.observer.setGlobal('puffinterval', ((0.04 * world.topology.maxPxcor) / (world.observer.getGlobal('scale') * world.observer.getGlobal('launchspeed'))));
}
function stepiss() {
  var dt = StrictMath.pow(10, world.observer.getGlobal('model_speed'));
  var xx = (world.observer.getGlobal('rx') + ((world.observer.getGlobal('rvx') * dt) / 2));
  var yy = (world.observer.getGlobal('ry') + ((world.observer.getGlobal('rvy') * dt) / 2));
  var r2 = (StrictMath.pow(xx, 2) + StrictMath.pow(yy, 2));
  var r = StrictMath.sqrt(r2);
  world.observer.setGlobal('time', (world.observer.getGlobal('time') + dt));
  if (Prims.gt(r, world.observer.getGlobal('eradk'))) {
    var r3 = (r * r2);
    var ax = (0 - ((world.observer.getGlobal('gm') * xx) / r3));
    var ay = (0 - ((world.observer.getGlobal('gm') * yy) / r3));
    world.observer.setGlobal('rvx', (world.observer.getGlobal('rvx') + (ax * dt)));
    world.observer.setGlobal('rvy', (world.observer.getGlobal('rvy') + (ay * dt)));
    world.observer.setGlobal('rx', (world.observer.getGlobal('rx') + (world.observer.getGlobal('rvx') * dt)));
    world.observer.setGlobal('ry', (world.observer.getGlobal('ry') + (world.observer.getGlobal('rvy') * dt)));
    Call(placeiss);
    Call(handlepuffs);
  }
  else {
    Call(showresults);
    Call(explode);
  }
}
function showresults() {
  var r = ((((world.observer.getGlobal('eradk') * 2) * 3.141592653589793) * Trig.atan(world.observer.getGlobal('rx'), world.observer.getGlobal('ry'))) / 360);
  Call(myOutputType, StrictMath.round(r));
  Call(myOutputType, "km   ");
  Call(myOutputType, world.observer.getGlobal('launchheading'));
  Call(myOutputType, "°   ");
  Call(myOutputType, world.observer.getGlobal('launchspeed'));
  Call(myOutputPrint, "km/s");
}
function handlepuffs() {
  if (Prims.gt(world.observer.getGlobal('time'), world.observer.getGlobal('nextpufftime'))) {
    world.turtleManager.createTurtles(1, 'PUFFS').ask(function() {
      world.observer.setGlobal('nextpufftime', (world.observer.getGlobal('nextpufftime') + world.observer.getGlobal('puffinterval')));
      SelfPrims.setVariable('x0', world.observer.getGlobal('rx'));
      SelfPrims.setVariable('y0', world.observer.getGlobal('ry'));
      SelfPrims.setVariable('shape', "circle");
      SelfPrims.setVariable('color', 15);
      var temp = Call(main, SelfPrims.getVariable('x0'), SelfPrims.getVariable('y0'));
      if (ListPrims.last(temp)) {
        SelfPrims.setXY(ListPrims.first(temp), ListPrims.item(1, temp));
        SelfPrims.setVariable('size', 2);
      }
      else {
        SelfPrims.setVariable('size', 0);
      }
    }, true);
  }
}
function placepuffs() {
  world.turtleManager.turtlesOfBreed("PUFFS").ask(function() {
    var temp = Call(main, SelfPrims.getVariable('x0'), SelfPrims.getVariable('y0'));
    if (ListPrims.last(temp)) {
      SelfPrims.setXY(ListPrims.first(temp), ListPrims.item(1, temp));
      SelfPrims.setVariable('size', 2);
    }
    else {
      SelfPrims.setVariable('size', 0);
    }
  }, true);
}
function placeiss() {
  if (world.observer.getGlobal('alive?')) {
    world.turtleManager.turtlesOfBreed("ISSS").ask(function() {
      SelfPrims.setVariable('heading', Trig.atan(world.observer.getGlobal('rvx'), world.observer.getGlobal('rvy')));
      var temp = Call(main, world.observer.getGlobal('rx'), world.observer.getGlobal('ry'));
      if (ListPrims.last(temp)) {
        SelfPrims.setXY(ListPrims.first(temp), ListPrims.item(1, temp));
        SelfPrims.setVariable('size', 16);
      }
      else {
        SelfPrims.setVariable('size', 0);
      }
    }, true);
  }
}
function placejunk() {
  world.turtleManager.turtlesOfBreed("JUNKPILES").ask(function() {
    var temp = Call(main, SelfPrims.getVariable('x1'), SelfPrims.getVariable('y1'));
    if (ListPrims.last(temp)) {
      SelfPrims.setXY(ListPrims.first(temp), ListPrims.item(1, temp));
      SelfPrims.setVariable('size', 16);
    }
    else {
      SelfPrims.setVariable('size', 0);
    }
  }, true);
}
function main(u, v) {
  var x = ((world.observer.getGlobal('scale') * u) + world.observer.getGlobal('b1'));
  var y = ((world.observer.getGlobal('scale') * v) + world.observer.getGlobal('b2'));
  if ((((Prims.lt(x, world.topology.maxPxcor) && Prims.gt(x, world.topology.minPxcor)) && Prims.lt(y, world.topology.maxPycor)) && Prims.gt(y, world.topology.minPycor))) {
    return ListPrims.list(x, y, true);
  }
  else {
    return ListPrims.list(x, y, false);
  }
}
function explode() {
  var sz = 10;
  world.turtleManager.turtlesOfBreed("ISSS").ask(function() {
    SelfPrims.setVariable('shape', "explosion");
  }, true);
  Prims.repeat(20, function() {
    world.turtleManager.turtlesOfBreed("ISSS").ask(function() {
      if (Prims.gt(SelfPrims.getVariable('size'), 0)) {
        SelfPrims.setVariable('size', sz);
      }
    }, true);
    sz = (sz + 2.2);
    Call(pause, 0.1);
  });
  world.turtleManager.turtlesOfBreed("ISSS").ask(function() {
    SelfPrims.setVariable('size', 0);
    SelfPrims.setVariable('shape', "ISS");
  }, true);
  world.turtleManager.createTurtles(1, 'JUNKPILES').ask(function() {
    SelfPrims.setVariable('shape', "junk");
    SelfPrims.setVariable('color', 9.9);
    SelfPrims.setVariable('heading', Trig.atan(world.observer.getGlobal('rx'), world.observer.getGlobal('ry')));
    SelfPrims.setVariable('x1', world.observer.getGlobal('rx'));
    SelfPrims.setVariable('y1', world.observer.getGlobal('ry'));
  }, true);
  Call(placejunk);
  world.observer.setGlobal('running?', false);
  world.observer.setGlobal('alive?', false);
}
function drawscene() {
  world.observer.setGlobal('scale', StrictMath.pow(10, world.observer.getGlobal('mainscale')));
  var v = 1;
  if (Prims.gt(world.observer.getGlobal('mainscale'), -3)) {
    v = ((1 - world.observer.getGlobal('mainscale')) / 4);
  }
  world.observer.setGlobal('ghp', (10 + (world.topology.maxPycor * v)));
  world.observer.setGlobal('moffp', (90 + ((world.topology.maxPxcor - 100) * v)));
  world.observer.setGlobal('b1', (world.observer.getGlobal('moffp') + world.topology.minPxcor));
  world.observer.setGlobal('b2', ((world.observer.getGlobal('ghp') + world.topology.minPycor) - (world.observer.getGlobal('scale') * world.observer.getGlobal('eradk'))));
  var tropotop = 10;
  var stratotop = 50;
  var earthtopp = (world.topology.minPycor + world.observer.getGlobal('ghp'));
  var mountainsizep = (world.observer.getGlobal('montainheight') * world.observer.getGlobal('scale'));
  var mountainx = (world.topology.minPxcor + world.observer.getGlobal('moffp'));
  world.clearPatches();
  world.patches().ask(function() {
    var x = ((SelfPrims.getPatchVariable('pxcor') - world.observer.getGlobal('b1')) / world.observer.getGlobal('scale'));
    var y = ((SelfPrims.getPatchVariable('pycor') - world.observer.getGlobal('b2')) / world.observer.getGlobal('scale'));
    var alt = (StrictMath.sqrt((StrictMath.pow(x, 2) + StrictMath.pow(y, 2))) - world.observer.getGlobal('eradk'));
    if (Prims.lt((alt + (0.6 * world.observer.getGlobal('eradk'))), 0)) {
      SelfPrims.setPatchVariable('pcolor', 9.9);
    }
    else {
      if (Prims.lt(alt, 0)) {
        if (Prims.lt(y, 0)) {
          SelfPrims.setPatchVariable('pcolor', 105);
        }
        else {
          SelfPrims.setPatchVariable('pcolor', 55);
        }
      }
      else {
        if (Prims.lt(alt, tropotop)) {
          SelfPrims.setPatchVariable('pcolor', 108);
        }
        else {
          if (Prims.lt(alt, stratotop)) {
            SelfPrims.setPatchVariable('pcolor', (100 + ((8 * (stratotop - alt)) / (stratotop - tropotop))));
          }
        }
      }
    }
  }, true);
  world.turtleManager.turtlesOfBreed("MOUNTAINS").ask(function() {
    SelfPrims.setXY(mountainx, (earthtopp + ((mountainsizep / 2) - 1)));
    SelfPrims.setVariable('size', mountainsizep);
  }, true);
  Call(placearrows);
  Call(placeiss);
  Call(placepuffs);
  Call(placejunk);
}
function myOutputType(string) {

}
function myOutputPrint(string) {

}
function myClearOutput() {

}
function pause(t) {

}
world.observer.setGlobal('launchheading', 20);
world.observer.setGlobal('mainscale', 1);
world.observer.setGlobal('launchspeed', 0.3);
world.observer.setGlobal('model_speed', 0);
      session.startLoop()
    </script>
  
  <script type="application/javascript" src="pause.js"></script>
  <script type="application/javascript" src="output.js"></script>

</body></html>
