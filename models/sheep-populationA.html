
<!-- saved from url=(0050)http://li425-91.members.linode.com:9000/save-nlogo -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="app.css" charset="utf-8"/>
  </head>
  <body>
    <div id="model-container"><div class="netlogo-model" style="width: 621;"><div class="netlogo-header"><label class="netlogo-widget netlogo-speed-slider"><span class="netlogo-label">speed</span> <input type="range" min="-1" max="1" step="0.01"></label> <div class="netlogo-powered-by"><a href="http://ccl.northwestern.edu/netlogo/"><img style="vertical-align: middle;" alt="NetLogo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANcSURBVHjarJRdaFxFFMd/M/dj7252uxubKms+bGprVyIVbNMWWqkQqtLUSpQWfSiV+oVFTcE3DeiDgvoiUSiCYLH2oVoLtQ+iaaIWWtE2FKGkkSrkq5svN+sm7ma/7p3x4W42lEbjQw8MM8yc87/nzPnNFVprbqWJXyMyXuMqx1Ni6N3ny3cX8tOHNLoBUMvESoFI2Xbs4zeO1lzREpSrMSNS1zkBDv6uo1/noz1H7mpvS4SjprAl2AZYEqzKbEowBAgBAkjPKX2599JjT7R0bj412D0JYNplPSBD1G2SmR/e6u1ikEHG2vYiGxoJmxAyIGSCI8GpCItKimtvl2JtfGujDNkX6epuAhCjNeAZxM1ocPy2Qh4toGQ5DLU+ysiuA2S3P0KgJkjAgEAlQylAA64CG/jlUk6//ng4cNWmLK0yOPNMnG99Rs9LQINVKrD+wmke7upg55PrWP3eYcwrlykpKCkoelDy/HVegQhoABNAepbACwjOt72gZkJhypX70YDWEEklue+rbnYc2MiGp1upPfYReiJJUUG58gFXu4udch1wHcjFIgy0HyIjb2yvBpT2F6t+6+f+D15lW8c9JDo7iPSdgVIRLUqL2AyHDQAOf9hfbqxvMF98eT3RuTS1avHyl+Stcphe2chP9+4k/t3RbXVl3W+Ws17FY56/w3VcbO/koS/eZLoAqrQMxADZMTYOfwpwoWjL4+bCYcgssMqGOzPD6CIkZ/3SxTJ0ayFIN6/BnBrZb2XdE1JUgkJWkfrUNRJnPyc16zsbgPyXIUJBpvc+y89nk/S8/4nek3NPGeBWMwzGvhUPnP6RubRLwfODlqqx3LSCyee2MnlwMwA2RwgO5qouVcHmksUdJweYyi8hZkrUjgT5t/ejNq0jBsSqNWsKyT9uFtxw7Bs585d3g46KOeT2bWHmtd14KyP+5mzqpsYU3OyioACMhGiqPTMocsrHId9cy9BLDzKxq8X3ctMwlV6yKSHL4fr4dd0DeQBTBUgUkvpE1kVPbqkX117ZzuSaFf4zyfz5n9A4lk0yNU7vyb7jTy1kmFGipejKvh6h9n0W995ZPTu227hqmCz33xXgFV1v9NzI96NfjndWt7XWCB/7BSICFWL+j3lAofpCtfYFb6X9MwCJZ07mUsXRGwAAAABJRU5ErkJggg=="> <span style="font-size: 16px;">powered by NetLogo</span></a></div></div> <div style="position: relative; width: 621; height: 414" class="netlogo-widget-container"><div class="netlogo-widget netlogo-view-container" style="position: absolute; left: 278px; top: 22px; width: 343px; height: 364px;"><div class="netlogo-widget netlogo-tick-counter">ticks: <span></span></div><div class="view-layers" style="width: 100%; position: relative;"><canvas width="666" height="666" class="patch-view" style="width: 100%; z-index: 0;"></canvas><canvas width="999" height="999" class="turtle-view" style="width: 100%; position: absolute; top: 0px; left: 0px; z-index: 1;"></canvas><canvas width="333" height="333" class="spotlight-view" style="width: 100%; position: absolute; top: 0px; left: 0px; z-index: 2;"></canvas></div></div>              <label class="netlogo-widget netlogo-slider netlogo-input" style="position: absolute; left: 104px; top: 10px; width: 150px; height: 33px;"><input type="range" max="250" min="0" step="5"> <span class="netlogo-label">initial-number</span> <span class="netlogo-value"><input type="number" min="0" max="250" step="5"> </span></label>         <label class="netlogo-widget netlogo-slider netlogo-input" style="position: absolute; left: 105px; top: 84px; width: 149px; height: 33px;"><input type="range" max="4" min="0" step="0.5"> <span class="netlogo-label">gain-from-food</span> <span class="netlogo-value"><input type="number" min="0" max="4" step="0.5"> </span></label>         <label class="netlogo-widget netlogo-slider netlogo-input" style="position: absolute; left: 104px; top: 48px; width: 148px; height: 33px;"><input type="range" max="95" min="0" step="5"> <span class="netlogo-label">grass-regrowth-rate</span> <span class="netlogo-value"><input type="number" min="0" max="95" step="5"> </span></label>       <button class="netlogo-widget netlogo-button netlogo-command" type="button" style="position: absolute; left: 15px; top: 11px; width: 69px; height: 33px;"><span>setup</span></button>         <button class="netlogo-widget netlogo-button netlogo-command" type="button" style="position: absolute; left: 14px; top: 52px; width: 81px; height: 33px;"><span>go once</span></button>               <div class="netlogo-widget netlogo-plot netlogo-plot-0 netlogo-output" style="position: absolute; left: 17px; top: 223px; width: 252px; height: 191px;" data-highcharts-chart="1"><div class="highcharts-container" id="highcharts-2" style="position: relative; overflow: hidden; width: 252px; height: 191px; text-align: left; line-height: normal; z-index: 0; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><svg version="1.1" style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Arial, Helvetica, sans-serif;font-size:12px;" xmlns="http://www.w3.org/2000/svg" width="252" height="191"><desc>Created with Highcharts 4.0.4</desc><defs><clippath id="highcharts-3"><rect x="0" y="0" width="168" height="49"></rect></clippath></defs><rect x="0" y="0" width="252" height="191" strokeWidth="0" fill="#FFFFFF" class=" highcharts-background"></rect><g class="highcharts-button" style="cursor:default;" stroke-linecap="round" transform="translate(218,10)"><title>Chart context menu</title><rect x="0.5" y="0.5" width="24" height="22" strokeWidth="1" fill="white" stroke="none" stroke-width="1" rx="2" ry="2"></rect><path fill="#E0E0E0" d="M 6 6.5 L 20 6.5 M 6 11.5 L 20 11.5 M 6 16.5 L 20 16.5" stroke="#666" stroke-width="3" zIndex="1"></path><text x="0" zIndex="1" style="color:black;fill:black;" y="13"></text></g><g class="highcharts-grid" zIndex="1"></g><g class="highcharts-grid" zIndex="1"><path fill="none" d="M 74 52.5 L 242 52.5" stroke="#C0C0C0" stroke-width="1" zIndex="1" opacity="1"></path><path fill="none" d="M 74 102.5 L 242 102.5" stroke="#C0C0C0" stroke-width="1" zIndex="1" opacity="1"></path></g><g class="highcharts-axis" zIndex="2"><path fill="none" d="M 157.5 102 L 157.5 112" stroke="#C0D0E0" stroke-width="1" opacity="1"></path><path fill="none" d="M 242.5 102 L 242.5 112" stroke="#C0D0E0" stroke-width="1" opacity="1"></path><path fill="none" d="M 73.5 102 L 73.5 112" stroke="#C0D0E0" stroke-width="1" opacity="1"></path><text x="158" zIndex="7" text-anchor="middle" transform="translate(0,0)" class=" highcharts-xaxis-title" style="color:#707070;fill:#707070;" visibility="visible" y="144">time</text><path fill="none" d="M 74 102.5 L 242 102.5" stroke="#C0D0E0" stroke-width="1" zIndex="7" visibility="visible"></path></g><g class="highcharts-axis" zIndex="2"><text x="28.125" zIndex="7" text-anchor="middle" transform="translate(0,0) rotate(270 28.125 77.5)" class=" highcharts-yaxis-title" style="color:#707070;fill:#707070;" visibility="visible" y="77.5">pop.</text></g><g class="highcharts-series-group" zIndex="3"><g class="highcharts-series" visibility="visible" zIndex="0.1" transform="translate(74,53) scale(1 1)" clip-path="url(#highcharts-3)"><path fill="none" d="M 0 0" stroke-linejoin="round" visibility="visible" stroke="rgba(192,192,192,0.0001)" stroke-width="22" zIndex="2" class=" highcharts-tracker" style=""></path></g><g class="highcharts-markers highcharts-tracker" visibility="visible" zIndex="0.1" transform="translate(74,53) scale(1 1)" clip-path="none" style=""></g><g class="highcharts-series" visibility="visible" zIndex="0.1" transform="translate(74,53) scale(1 1)" clip-path="url(#highcharts-3)"><path fill="none" d="M 0 0" stroke-linejoin="round" visibility="visible" stroke="rgba(192,192,192,0.0001)" stroke-width="22" zIndex="2" class=" highcharts-tracker" style=""></path></g><g class="highcharts-markers highcharts-tracker" visibility="visible" zIndex="0.1" transform="translate(74,53) scale(1 1)" clip-path="none" style=""></g></g><text x="126" text-anchor="middle" class="highcharts-title" zIndex="4" style="color:#333333;font-size:18px;fill:#333333;width:188px;" y="25">populations</text><g class="highcharts-legend" zIndex="7" transform="translate(57,155)"><g zIndex="1"><g><g class="highcharts-legend-item" zIndex="1" transform="translate(8,3)"><path fill="none" d="M 0 11 L 16 11" stroke="rgb(3, 3, 3)" stroke-width="2"></path><text x="21" style="color:#333333;font-size:12px;font-weight:bold;cursor:pointer;fill:#333333;" text-anchor="start" zIndex="2" y="15">sheep</text></g><g class="highcharts-legend-item" zIndex="1" transform="translate(84.703125,3)"><path fill="none" d="M 0 11 L 16 11" stroke="rgb(89, 176, 60)" stroke-width="2"></path><text x="21" y="15" style="color:#333333;font-size:12px;font-weight:bold;cursor:pointer;fill:#333333;" text-anchor="start" zIndex="2">grass</text></g></g></g></g><g class="highcharts-axis-labels highcharts-xaxis-labels" zIndex="7"><text x="74" text-anchor="middle" style="color:#606060;cursor:default;font-size:11px;fill:#606060;" y="122" opacity="1">0</text><text x="158" text-anchor="middle" style="color:#606060;cursor:default;font-size:11px;fill:#606060;" y="122" opacity="1">10</text><text x="242" text-anchor="middle" style="color:#606060;cursor:default;font-size:11px;fill:#606060;" y="122" opacity="1">20</text></g><g class="highcharts-axis-labels highcharts-yaxis-labels" zIndex="7"><text x="59" text-anchor="end" style="width:63px;color:#606060;cursor:default;font-size:11px;fill:#606060;" y="105.5" opacity="1">0</text><text x="59" text-anchor="end" style="width:63px;color:#606060;cursor:default;font-size:11px;fill:#606060;" y="56.5" opacity="1">100</text></g><g class="highcharts-tooltip" zIndex="8" style="cursor:default;padding:0;white-space:nowrap;" transform="translate(0,-9999)"><path fill="none" d="M 3 0 L 13 0 C 16 0 16 0 16 3 L 16 13 C 16 16 16 16 13 16 L 3 16 C 0 16 0 16 0 13 L 0 3 C 0 0 0 0 3 0" isShadow="true" stroke="black" stroke-opacity="0.049999999999999996" stroke-width="5" transform="translate(1, 1)"></path><path fill="none" d="M 3 0 L 13 0 C 16 0 16 0 16 3 L 16 13 C 16 16 16 16 13 16 L 3 16 C 0 16 0 16 0 13 L 0 3 C 0 0 0 0 3 0" isShadow="true" stroke="black" stroke-opacity="0.09999999999999999" stroke-width="3" transform="translate(1, 1)"></path><path fill="none" d="M 3 0 L 13 0 C 16 0 16 0 16 3 L 16 13 C 16 16 16 16 13 16 L 3 16 C 0 16 0 16 0 13 L 0 3 C 0 0 0 0 3 0" isShadow="true" stroke="black" stroke-opacity="0.15" stroke-width="1" transform="translate(1, 1)"></path><path fill="rgba(249, 249, 249, .85)" d="M 3 0 L 13 0 C 16 0 16 0 16 3 L 16 13 C 16 16 16 16 13 16 L 3 16 C 0 16 0 16 0 13 L 0 3 C 0 0 0 0 3 0"></path><text x="8" zIndex="1" style="font-size:12px;color:#333333;fill:#333333;" y="21"></text></g></svg></div></div>       <div class="netlogo-widget netlogo-monitor netlogo-output" style="position: absolute; left: 91px; top: 163px; width: 73px; height: 45px;"><div class="netlogo-label">population</div> <output class="netlogo-value">0</output></div>         <div class="netlogo-widget netlogo-monitor netlogo-output" style="position: absolute; left: 19px; top: 163px; width: 50px; height: 45px;"><div class="netlogo-label">year</div> <output class="netlogo-value">0</output></div>      <label class="netlogo-widget netlogo-button netlogo-forever-button  netlogo-command" style="position: absolute; left: 12px; top: 94px; width: 82px; height: 33px;"><input type="checkbox"> <span class="netlogo-label">go/stop</span></label>          <label class="netlogo-widget netlogo-slider netlogo-input" style="position: absolute; left: 105px; top: 121px; width: 148px; height: 33px;"><input type="range" max="100" min="0" step="1"> <span class="netlogo-label">birthrate-%</span> <span class="netlogo-value"><input type="number" min="0" max="100" step="1"> </span></label>           <div class="netlogo-widget netlogo-monitor netlogo-output" style="position: absolute; left: 194px; top: 165px; width: 59px; height: 45px;"><div class="netlogo-label">% grass</div> <output class="netlogo-value">0</output></div>  </div> <div class="netlogo-tabs"><label class="netlogo-code-tab netlogo-tab netlogo-command "><input type="checkbox"> NetLogo Code</label> <label class="netlogo-info-tab netlogo-tab netlogo-command "><input type="checkbox"> Model Info</label></div> <div class="netlogo-model-text"> </div></div></div>
    <script type="text/string" id="nlogo-code">globals [ year   year-length   avg-pop ]
breed [ males ]
breed [ females ]

turtles-own [ energy  teeth  age ]
males-own [  ]          
females-own [   ]  
patches-own [ countdown]
  
  
to startup
setup
end

to setup 
  ca
  set year 0
  set year-length 12
  ask patches [
      set pcolor green
      set countdown random (101 - grass-regrowth-rate) ;; initialize grass grow clocks randomly
      if (random 2) = 0  ;;half the patches start out with grass
          [ set pcolor brown ]
      create-fences
    ]
 
  set-default-shape females "ewes"
  set-default-shape males "rams2"
  create-males (initial-number / 2)  ;; create the males, then initialize their variables
  [ 
    set color white
    set size 3.5
    set age random 5
    set energy random (2 * gain-from-food)
    setxy random-float world-width
          random-float world-height
    repeat 6 [if pcolor = red [rt 90 fd 3 ]]
  ] 
  
    create-females (initial-number / 2)  ;; create the females, then initialize their variables
  [ 
    set color white
    set size 3.5
    set age random 5
    set energy random (2 * gain-from-food)
    setxy random-float world-width
          random-float world-height
    if pcolor = red [rt 180 fd 1] 
    repeat 6 [if pcolor = red [rt 90 fd 3 ]]
]  

  set avg-pop initial-number
  do-plot
end

to go
  repeat year-length [
  ask males [
        move
        eat-grass
        death
        ] 
  
    ask females [
        move
        eat-grass 
        death
        ]
    ask patches [ grow-grass ]
    display
    ] 
    
    ask males  [ 
      set age age + 1
    ]
    
    ask females [
      set age age + 1 
      if age > 1 and age <= 6 [reproduce]
    ]
    set year year + 1
    do-plot  ;; plot populations
  if not any? turtles [ stop ]
end

to move  ;; turtle procedure
  rt random-float 50 - random-float 50
  fd 1
  if pcolor = red [rt 180 fd 1] 
end

to eat-grass  ;; turtle procedure
  ;; sheep eat grass, turn the patch brown
    set energy energy - 1 ;; lose energy when they move 
    if pcolor = green 
      [ set energy  energy + gain-from-food 
      set pcolor brown]
end

to reproduce  ;;turtle procedure
  if random 100 < birthrate-%
    [ breed-and-birth ] ;; females mate with any ram in the whole field, "birth-rate" percent of the time 
end

to breed-and-birth ;; turtle procedure
  if count males > 0 [  ;; use this to prevent a runtime error if the population is near to extinction
    hatch 1 [
    fd 10
    set age 0
    set energy 3
    ifelse (random 2 = 1) 
      [set breed males] 
      [set breed females]
     ] ]
end


to death  ;; turtle procedure
  ;; when energy dips below zero, or sheep gets old, die
  if energy < 0 [ die ] 
  if age > 6 [die ]
end

to create-fences ;; patch procedure
if (abs pxcor) = max-pxcor   [set pcolor red]
if (abs pycor) = max-pycor [set pcolor red]
end

to grow-grass  ;; patch procedure
  ;; countdown on brown patches, if reach 0, grow some grass
  if pcolor = brown [ 
    ifelse countdown <= 0
      [ set pcolor green
        set countdown (102 - grass-regrowth-rate) ] 
      [ set countdown (countdown - 1) ] 
  ] 
end

to smooth
  set avg-pop (0.9 * avg-pop + 0.1 * count turtles)
end

to do-plot 
  smooth
  set-current-plot "populations"
  set-current-plot-pen "sheep" 
    plot (count turtles)       
;  set-current-plot-pen "avg-total"
;    plot avg-pop         
 
  ;; divide by four to keep it within similar range as sheep populations                                         
  set-current-plot-pen "grass"
    plot (count patches with [pcolor = green]) / 4
  
end

</script>
    <script type="text/string" id="nlogo-info">
		Evolution:  Sheep-populationA
 This is a model of a flock of sheep whose survival depends on eating grass. One can study the effect on the population of initial number, grass regrowth rate, and birthrate.

Here are are some explorations:

1. Picture yourself as a rancher with a large field of sheep. You start with an equal number of males (horns) and females (no horns). They live for six years. The sheep move around the field and eat grass, which grows back at a certain rate. The patch is green if there is grass there, and brown if there is no grass. In the model, the sheep move and eat during the year. They use up energy as they move, and gain energy from eating grass. If their energy goes to zero, they die. 

2. Once a year, from age 3 to age 6, each female gives birth to a baby. 

3. To run the model, always first hit SETUP. Hit GO-ONCE to run the model for one year. Hit GO-FOREVER to run the model continuously. To stop, hit the same button again. The graph shows the amount of grass (green) and the total population (black) as time goes by.

4. Run the model for about 50 years. What do you observe about the relationship between the grass and the population? 
5. 
Use GO-ONCE instead of GO-FOREVER, and run one year at a time. Look more carefully at the relationship between sheep and grass. If you drag the cursor onto the graph, you can read values at the location of the cursor. Before you run the next year, try to predict whether the sheep and grass will go up or down. Describe what you observe.

6. What causes this pattern?

7. Using the GO-FOREVER button, run the model for 100 years. Even though the population always goes up and down, what is the ÒaverageÓ value that is roughly at the center of these fluctuations? 

8.  Look at the last 30 years (year 70 to year 100). How big are the fluctuations? 
Maximum population	
Minimum population	
Size of fluctuation	

9. Suppose you had thousands of sheep, in a much larger field, instead of a few hundred. Do you think the population would be steadier?
a. [ ] Yes, fluctuations not so big.
b. [  ] No, larger fluctuations.
c. [  ] It would make no difference.

10. Why do you think so?

11. The model allows you to adjust several factors. Try changing them one at a time, following the steps below. After that, you can do other experiments on your own. Here are the starting values:
¥ INITIAL-NUMBER = starting number of sheep = 100 
¥ GRASS-REGROWTH-RATE = how fast the grass grows back = 80
¥ GAIN-FROM-FOOD = amount of food they gain from eating a square of grass = 2.0
¥ BIRTHRATE-% = chance that a female will have a baby once a year = 100%

12. Suppose the starting number was 200, in the same field. What would happen to the average population after a period of time, compared to a starting number of 100? 
a. [  ] It would be greater
b. [  ] It would be less
c. [  ] It would be about the same

13. Now try it. You must hit SETUP each time you change INITIAL-NUMBER.
a. Set INITIAL-NUMBER = 200. Hit SETUP, then GO-FOREVER. Run it for 50 years. Notice the average long-term population. Fill in the table. 
b. Set INITIAL-NUMBER = 100 and again notice the average long-term population after 50 years. Fill in the table. 
c. Set INITIAL-NUMBER = 50. Fill in the table. 

INITIAL-NUMBER	Average long-term population
200	
100	
50	

14. Is there a pattern in the long-term population?
a. [  ] It is greater if the initial number is greater
b. [  ] It is less if the initial number is greater
c. [  ] It is about the same
d. [  ] It changes but there is no pattern  

15. How can you explain this result?

16. What would happen to the average population if you decreased GRASS-REGROWTH-RATE? This might be caused by a decrease in rainfall.
a. [  ] It would decrease
b. [  ] It would increase
c. [  ] It would stay the same

17. Now try it. Set INITIAL-NUMBER back to 100. Run the model and try different values of GRASS-REGROWTH-RATE. You can change GRASS-REGROWTH-RATE while the model is running. Fill in the table. 

GRASS-REGROWTH-RATE	Average long-term population
95	
80	
50	

18. What happens to the population?
a. [  ] It is greater if the grass growth rate is greater
b. [  ] It is less if the grass growth rate is greater
c. [  ] It is about the same  
d. [  ] There is no pattern

19. How can you explain this result?

20. What would happen to the average population if GAIN-FROM-FOOD (the energy sheep get from eating grass) were reduced? This might correspond to a grass that was less nutritious.
e. [  ] It would decrease
f. [  ] It would increase
g. [  ] It would stay the same

21. Now try it. Set GRASS-REGROWTH-RATE back to 80. Run the model and try different values of GAIN-FROM-FOOD. You can change GAIN-FROM-FOOD while the model is running. Fill in the table.

GAIN-FROM-FOOD	Average long-term population
3	
2.5	
2	
1.5	
1	

Describe the pattern you observe and explain why you think this happens.

To explore other features of this population, go on to sheep-populationB.

To explore evolutionary adaptation, go on to sheep-selection.


</script>
<script type="text/javascript" src="app.js"></script>
    <script type="text/javascript">
;

      var widgets = [{"left":278,"top":22,"right":621,"bottom":386,"patchSize":9.0,"fontSize":12,"wrappingAllowedInX":true,"wrappingAllowedInY":true,"minPxcor":-18,"maxPxcor":18,"minPycor":-18,"maxPycor":18,"updateMode":"Continuous","showTickCounter":true,"tickCounterLabel":"ticks","frameRate":30.0,"type":"view"},{"display":"initial-number","left":104,"top":10,"right":254,"bottom":43,"varName":"initial-number","min":"0","max":"250","default":70.0,"step":"5","units":null,"direction":"horizontal","type":"slider","compiledMin":{"success":true,"result":"0"},"compiledMax":{"success":true,"result":"250"},"compiledStep":{"success":true,"result":"5"}},{"display":"gain-from-food","left":105,"top":84,"right":254,"bottom":117,"varName":"gain-from-food","min":"0.0","max":"4","default":2.0,"step":"0.5","units":null,"direction":"horizontal","type":"slider","compiledMin":{"success":true,"result":"0"},"compiledMax":{"success":true,"result":"4"},"compiledStep":{"success":true,"result":"0.5"}},{"display":"grass-regrowth-rate","left":104,"top":48,"right":252,"bottom":81,"varName":"grass-regrowth-rate","min":"0","max":"95","default":80.0,"step":"5","units":null,"direction":"horizontal","type":"slider","compiledMin":{"success":true,"result":"0"},"compiledMax":{"success":true,"result":"95"},"compiledStep":{"success":true,"result":"5"}},{"display":"setup","left":15,"top":11,"right":84,"bottom":44,"source":"setup","forever":false,"buttonType":"OBSERVER","actionKey":null,"type":"button","compiledSource":{"success":true,"result":"Call(setup);"}},{"display":"go once","left":14,"top":52,"right":95,"bottom":85,"source":"go","forever":false,"buttonType":"OBSERVER","actionKey":null,"type":"button","compiledSource":{"success":true,"result":"Call(go);"}},{"display":"populations","left":17,"top":223,"right":269,"bottom":414,"xAxis":"time","yAxis":"pop.","xmin":0.0,"xmax":20.0,"ymin":0.0,"ymax":100.0,"autoPlotOn":true,"legendOn":true,"setupCode":"","updateCode":"","pens":[{"display":"sheep","interval":1.0,"mode":0,"color":-16777216,"inLegend":true,"setupCode":"","updateCode":"","type":"pen","compiledSetupCode":{"success":true,"result":""},"compiledUpdateCode":{"success":true,"result":""}},{"display":"grass","interval":1.0,"mode":0,"color":-10899396,"inLegend":true,"setupCode":"","updateCode":"","type":"pen","compiledSetupCode":{"success":true,"result":""},"compiledUpdateCode":{"success":true,"result":""}}],"type":"plot","compiledSetupCode":{"success":true,"result":""},"compiledUpdateCode":{"success":true,"result":""}},{"display":"population","left":91,"top":163,"right":164,"bottom":208,"source":"count turtles","precision":3,"fontSize":11,"type":"monitor","compiledSource":{"success":true,"result":"world.turtles().size()"}},{"display":"year","left":19,"top":163,"right":69,"bottom":208,"source":"year","precision":0,"fontSize":11,"type":"monitor","compiledSource":{"success":true,"result":"world.observer.getGlobal('year')"}},{"display":"go/stop","left":12,"top":94,"right":94,"bottom":127,"source":"go","forever":true,"buttonType":"OBSERVER","actionKey":null,"type":"button","compiledSource":{"success":true,"result":"Call(go);"}},{"display":"birthrate-%","left":105,"top":121,"right":253,"bottom":154,"varName":"birthrate-%","min":"0","max":"100","default":100.0,"step":"1","units":null,"direction":"horizontal","type":"slider","compiledMin":{"success":true,"result":"0"},"compiledMax":{"success":true,"result":"100"},"compiledStep":{"success":true,"result":"1"}},{"display":"% grass","left":194,"top":165,"right":253,"bottom":210,"source":"100 * (count patches with [pcolor = green]) / (count patches)","precision":0,"fontSize":11,"type":"monitor","compiledSource":{"success":true,"result":"((100 * world.patches().agentFilter(function() {\n  return Prims.equality(SelfPrims.getPatchVariable('pcolor'), 55);\n}).size()) / world.patches().size())"}}];
      var code    = document.querySelector("#nlogo-code").textContent;
      var info    = document.querySelector("#nlogo-info").textContent;
      var session = Tortoise.fromCompiledModel('#model-container', widgets, code, info, '', true);
      var modelConfig  = (typeof window.modelConfig !== "undefined" && window.modelConfig !== null) ? window.modelConfig : {};
var modelPlotOps = (typeof modelConfig.plotOps !== "undefined" && modelConfig.plotOps !== null) ? modelConfig.plotOps : {};

var PenBundle = tortoise_require('engine/plot/pen');
var Plot      = tortoise_require('engine/plot/plot');
var PlotOps   = tortoise_require('engine/plot/plotops');

modelConfig.plots = [(function() {
  var name    = 'populations';
  var plotOps = (typeof modelPlotOps[name] !== "undefined" && modelPlotOps[name] !== null) ? modelPlotOps[name] : new PlotOps(function() {}, function() {}, function() {}, function() { return function() {}; }, function() { return function() {}; }, function() { return function() {}; });
  var pens    = [new PenBundle.Pen('sheep', plotOps.makePenOps, false, new PenBundle.State(0.0, 1.0, PenBundle.DisplayMode.Line), function() { workspace.rng.withAux(function() { plotManager.withTemporaryContext('populations', 'sheep')(function() {}); }); }, function() { workspace.rng.withAux(function() { plotManager.withTemporaryContext('populations', 'sheep')(function() {}); }); }),
new PenBundle.Pen('grass', plotOps.makePenOps, false, new PenBundle.State(55.0, 1.0, PenBundle.DisplayMode.Line), function() { workspace.rng.withAux(function() { plotManager.withTemporaryContext('populations', 'grass')(function() {}); }); }, function() { workspace.rng.withAux(function() { plotManager.withTemporaryContext('populations', 'grass')(function() {}); }); })];
  var setup   = function() { workspace.rng.withAux(function() { plotManager.withTemporaryContext('populations', undefined)(function() {}); }); };
  var update  = function() { workspace.rng.withAux(function() { plotManager.withTemporaryContext('populations', undefined)(function() {}); }); };
  return new Plot(name, pens, plotOps, 'time', 'pop.', true, 0.0, 20.0, 0.0, 100.0, setup, update);
})()];

var workspace = tortoise_require('engine/workspace')(modelConfig)([{ name: 'MALES', singular: 'turtle', varNames: [] }, { name: 'FEMALES', singular: 'turtle', varNames: [] }])(['energy', 'teeth', 'age'], [])(['initial-number', 'gain-from-food', 'grass-regrowth-rate', 'birthrate-%', 'year', 'year-length', 'avg-pop'], ['initial-number', 'gain-from-food', 'grass-regrowth-rate', 'birthrate-%'], ['countdown'], -18, 18, -18, 18, 9.0, true, true, {"default":{"rotate":true,"elements":[{"xcors":[150,40,150,260],"ycors":[5,250,205,250],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"ewes":{"rotate":false,"elements":[{"xcors":[91,70,41,16,1,2,23,49,49,58,48,61,85,72,90,122,152,198,190,201,231,215,227,229,220,241,249,252,270,259,239,195,168,140,122],"ycors":[124,96,91,101,127,147,170,175,202,216,248,293,292,251,208,220,220,212,252,287,288,249,186,173,146,153,179,191,189,148,121,116,116,116,123],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[247,218,215,237],"ycors":[175,151,142,144],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[84,135,169,200,198,104,75],"ycors":[218,233,229,224,207,203,203],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[3,12,29,39,63],"ycors":[126,97,88,88,94],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[269,263,247,253],"ycors":[188,212,208,192],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true}]},"link":{"rotate":true,"elements":[{"x1":150,"y1":0,"x2":150,"y2":300,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"link direction":{"rotate":true,"elements":[{"x1":150,"y1":150,"x2":30,"y2":225,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":150,"y1":150,"x2":270,"y2":225,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"rams":{"rotate":false,"elements":[{"xcors":[93,226,246,271,283,286,269,256,240,221,232,230,219,240,205,185,192,158,110,91,80,90,60,38,60,51,46,45,20,6,2,2,3,18,45,71,105,114,108,98,100,90,70,55,73,83],"ycors":[94,95,101,126,161,190,195,176,151,139,185,221,250,295,295,238,197,193,195,199,248,294,296,232,177,165,149,140,136,115,101,85,68,55,38,33,43,68,83,81,65,58,56,66,71,90],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[93,157,194,233,177],"ycors":[93,81,81,95,122],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[90,135,193,152,103],"ycors":[196,203,199,186,189],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true}]},"rams2":{"rotate":false,"elements":[{"xcors":[92,157,238,266,274,270,260,248,229,242,242,232,251,225,204,208,155,92,56,67,39,30,72,59,35,15,3,1,12,47,13,52,78,110,126,129,116,103,111,99,69,64,82,92,126,155,156],"ycors":[102,97,108,146,183,199,197,159,137,184,208,250,292,295,240,195,202,181,206,252,252,199,157,127,125,120,100,68,46,35,47,28,22,25,39,53,73,74,55,39,42,50,66,90,91,97,98],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[69,83,58,57],"ycors":[55,41,40,56],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true}]},"sheep":{"rotate":false,"elements":[{"xmin":90,"ymin":75,"xmax":270,"ymax":225,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"x":15,"y":75,"diam":150,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xmin":81,"ymin":225,"xmax":134,"ymax":286,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":180,"ymin":225,"xmax":238,"ymax":285,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":1,"y":88,"diam":92,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":35,"ymin":108,"xmax":38,"ymax":119,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"x":75,"y":91,"diam":44,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"x":73,"y":98,"diam":108,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"x":19,"y":103,"diam":81,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"x":39,"y":81,"diam":64,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"x":29,"y":159,"diam":34,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"x":20,"y":147,"diam":24,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"x":44,"y":108,"diam":3,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":52,"y":120,"diam":3,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":0,"y":56,"diam":110,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":80,"ymin":227,"xmax":137,"ymax":289,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xmin":181,"ymin":229,"xmax":240,"ymax":287,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"x":-2,"y":56,"diam":115,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true}]},"sheep2":{"rotate":false,"elements":[{"xmin":64,"ymin":116,"xmax":243,"ymax":214,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xmin":244,"ymin":214,"xmax":244,"ymax":215,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xmin":244,"ymin":215,"xmax":245,"ymax":216,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xmin":91,"ymin":220,"xmax":127,"ymax":280,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xmin":189,"ymin":221,"xmax":224,"ymax":283,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xmin":189,"ymin":221,"xmax":189,"ymax":220,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"x":12,"y":65,"diam":105,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[129,195,257,246],"ycors":[116,105,124,175],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[258,271,264,251],"ycors":[128,193,195,157],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[58,90,94,76,59,63],"ycors":[69,72,111,118,110,84],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":false},{"xcors":[63,50,76],"ycors":[93,115,117],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":false},{"xcors":[224,190,191],"ycors":[219,218,225],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xmin":190,"ymin":221,"xmax":225,"ymax":226,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xmin":92,"ymin":220,"xmax":127,"ymax":225,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true},{"xcors":[250,253,264,276,274,257],"ycors":[164,196,198,195,159,128],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":true}]},"wolf":{"rotate":false,"elements":[{"xmin":15,"ymin":105,"xmax":105,"ymax":165,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":45,"ymin":90,"xmax":105,"ymax":105,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[60,83,104],"ycors":[90,44,90],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[67,82,97],"ycors":[90,59,89],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":48,"ymin":93,"xmax":59,"ymax":105,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xmin":51,"ymin":96,"xmax":55,"ymax":101,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":0,"ymin":121,"xmax":15,"ymax":135,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":15,"ymin":136,"xmax":60,"ymax":151,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[15,23,31],"ycors":[136,149,136],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[30,37,43],"ycors":[151,136,151],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xmin":105,"ymin":120,"xmax":263,"ymax":195,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":108,"ymin":195,"xmax":259,"ymax":201,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":114,"ymin":201,"xmax":252,"ymax":210,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":120,"ymin":210,"xmax":243,"ymax":214,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":115,"ymin":114,"xmax":255,"ymax":120,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":128,"ymin":108,"xmax":248,"ymax":114,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":150,"ymin":105,"xmax":225,"ymax":108,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":132,"ymin":214,"xmax":155,"ymax":270,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":110,"ymin":260,"xmax":132,"ymax":270,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":210,"ymin":214,"xmax":232,"ymax":270,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":189,"ymin":260,"xmax":210,"ymax":270,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":263,"y1":127,"x2":281,"y2":155,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":281,"y1":155,"x2":281,"y2":192,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]}}, {"default":{}});

var BreedManager  = workspace.breedManager;
var LayoutManager = workspace.layoutManager;
var LinkPrims     = workspace.linkPrims;
var ListPrims     = workspace.listPrims;
var MousePrims    = workspace.mousePrims;
var plotManager   = workspace.plotManager;
var Prims         = workspace.prims;
var SelfPrims     = workspace.selfPrims;
var SelfManager   = workspace.selfManager;
var Updater       = workspace.updater;
var world         = workspace.world;

var Call           = tortoise_require('util/call');
var ColorModel     = tortoise_require('util/colormodel');
var Exception      = tortoise_require('util/exception');
var Trig           = tortoise_require('util/trig');
var Type           = tortoise_require('util/typechecker');
var notImplemented = tortoise_require('util/notimplemented');

var Dump      = tortoise_require('engine/dump');
var Link      = tortoise_require('engine/core/link');
var LinkSet   = tortoise_require('engine/core/linkset');
var Nobody    = tortoise_require('engine/core/nobody');
var PatchSet  = tortoise_require('engine/core/patchset');
var Turtle    = tortoise_require('engine/core/turtle');
var TurtleSet = tortoise_require('engine/core/turtleset');
var Tasks     = tortoise_require('engine/prim/tasks');

var AgentModel = tortoise_require('agentmodel');
var Denuller   = tortoise_require('nashorn/denuller');
var Random     = tortoise_require('shim/random');
var StrictMath = tortoise_require('shim/strictmath');
function startup() {
  Call(setup);
}
function setup() {
  world.clearAll();
  world.observer.setGlobal('year', 0);
  world.observer.setGlobal('year-length', 12);
  world.patches().ask(function() {
    SelfPrims.setPatchVariable('pcolor', 55);
    SelfPrims.setPatchVariable('countdown', Prims.random((101 - world.observer.getGlobal('grass-regrowth-rate'))));
    if (Prims.equality(Prims.random(2), 0)) {
      SelfPrims.setPatchVariable('pcolor', 35);
    }
    Call(createFences);
  }, true);
  BreedManager.setDefaultShape(world.turtleManager.turtlesOfBreed("FEMALES").getBreedName(), "ewes")
  BreedManager.setDefaultShape(world.turtleManager.turtlesOfBreed("MALES").getBreedName(), "rams2")
  world.turtleManager.createTurtles((world.observer.getGlobal('initial-number') / 2), 'MALES').ask(function() {
    SelfPrims.setVariable('color', 9.9);
    SelfPrims.setVariable('size', 3.5);
    SelfPrims.setVariable('age', Prims.random(5));
    SelfPrims.setVariable('energy', Prims.random((2 * world.observer.getGlobal('gain-from-food'))));
    SelfPrims.setXY(Prims.randomFloat(world.topology.width), Prims.randomFloat(world.topology.height));
    Prims.repeat(6, function() {
      if (Prims.equality(SelfPrims.getPatchVariable('pcolor'), 15)) {
        SelfPrims.right(90);
        SelfPrims.fd(3);
      }
    });
  }, true);
  world.turtleManager.createTurtles((world.observer.getGlobal('initial-number') / 2), 'FEMALES').ask(function() {
    SelfPrims.setVariable('color', 9.9);
    SelfPrims.setVariable('size', 3.5);
    SelfPrims.setVariable('age', Prims.random(5));
    SelfPrims.setVariable('energy', Prims.random((2 * world.observer.getGlobal('gain-from-food'))));
    SelfPrims.setXY(Prims.randomFloat(world.topology.width), Prims.randomFloat(world.topology.height));
    if (Prims.equality(SelfPrims.getPatchVariable('pcolor'), 15)) {
      SelfPrims.right(180);
      SelfPrims.fd(1);
    }
    Prims.repeat(6, function() {
      if (Prims.equality(SelfPrims.getPatchVariable('pcolor'), 15)) {
        SelfPrims.right(90);
        SelfPrims.fd(3);
      }
    });
  }, true);
  world.observer.setGlobal('avg-pop', world.observer.getGlobal('initial-number'));
  Call(doPlot);
}
function go() {
  Prims.repeat(world.observer.getGlobal('year-length'), function() {
    world.turtleManager.turtlesOfBreed("MALES").ask(function() {
      Call(move);
      Call(eatGrass);
      Call(death);
    }, true);
    world.turtleManager.turtlesOfBreed("FEMALES").ask(function() {
      Call(move);
      Call(eatGrass);
      Call(death);
    }, true);
    world.patches().ask(function() {
      Call(growGrass);
    }, true);
    notImplemented('display', undefined)();
  });
  world.turtleManager.turtlesOfBreed("MALES").ask(function() {
    SelfPrims.setVariable('age', (SelfPrims.getVariable('age') + 1));
  }, true);
  world.turtleManager.turtlesOfBreed("FEMALES").ask(function() {
    SelfPrims.setVariable('age', (SelfPrims.getVariable('age') + 1));
    if ((Prims.gt(SelfPrims.getVariable('age'), 1) && Prims.lte(SelfPrims.getVariable('age'), 6))) {
      Call(reproduce);
    }
  }, true);
  world.observer.setGlobal('year', (world.observer.getGlobal('year') + 1));
  Call(doPlot);
  if (!world.turtles().nonEmpty()) {
    throw new Exception.StopInterrupt;
  }
}
function move() {
  SelfPrims.right((Prims.randomFloat(50) - Prims.randomFloat(50)));
  SelfPrims.fd(1);
  if (Prims.equality(SelfPrims.getPatchVariable('pcolor'), 15)) {
    SelfPrims.right(180);
    SelfPrims.fd(1);
  }
}
function eatGrass() {
  SelfPrims.setVariable('energy', (SelfPrims.getVariable('energy') - 1));
  if (Prims.equality(SelfPrims.getPatchVariable('pcolor'), 55)) {
    SelfPrims.setVariable('energy', (SelfPrims.getVariable('energy') + world.observer.getGlobal('gain-from-food')));
    SelfPrims.setPatchVariable('pcolor', 35);
  }
}
function reproduce() {
  if (Prims.lt(Prims.random(100), world.observer.getGlobal('birthrate-%'))) {
    Call(breedAndBirth);
  }
}
function breedAndBirth() {
  if (Prims.gt(world.turtleManager.turtlesOfBreed("MALES").size(), 0)) {
    SelfPrims.hatch(1, '').ask(function() {
      SelfPrims.fd(10);
      SelfPrims.setVariable('age', 0);
      SelfPrims.setVariable('energy', 3);
      if (Prims.equality(Prims.random(2), 1)) {
        SelfPrims.setVariable('breed', world.turtleManager.turtlesOfBreed("MALES"));
      }
      else {
        SelfPrims.setVariable('breed', world.turtleManager.turtlesOfBreed("FEMALES"));
      }
    }, true);
  }
}
function death() {
  if (Prims.lt(SelfPrims.getVariable('energy'), 0)) {
    SelfPrims.die();
  }
  if (Prims.gt(SelfPrims.getVariable('age'), 6)) {
    SelfPrims.die();
  }
}
function createFences() {
  if (Prims.equality(StrictMath.abs(SelfPrims.getPatchVariable('pxcor')), world.topology.maxPxcor)) {
    SelfPrims.setPatchVariable('pcolor', 15);
  }
  if (Prims.equality(StrictMath.abs(SelfPrims.getPatchVariable('pycor')), world.topology.maxPycor)) {
    SelfPrims.setPatchVariable('pcolor', 15);
  }
}
function growGrass() {
  if (Prims.equality(SelfPrims.getPatchVariable('pcolor'), 35)) {
    if (Prims.lte(SelfPrims.getPatchVariable('countdown'), 0)) {
      SelfPrims.setPatchVariable('pcolor', 55);
      SelfPrims.setPatchVariable('countdown', (102 - world.observer.getGlobal('grass-regrowth-rate')));
    }
    else {
      SelfPrims.setPatchVariable('countdown', (SelfPrims.getPatchVariable('countdown') - 1));
    }
  }
}
function smooth() {
  world.observer.setGlobal('avg-pop', ((0.9 * world.observer.getGlobal('avg-pop')) + (0.1 * world.turtles().size())));
}
function doPlot() {
  Call(smooth);
  plotManager.setCurrentPlot("populations");
  plotManager.setCurrentPen("sheep");
  plotManager.plotValue(world.turtles().size());
  plotManager.setCurrentPen("grass");
  plotManager.plotValue((world.patches().agentFilter(function() {
    return Prims.equality(SelfPrims.getPatchVariable('pcolor'), 55);
  }).size() / 4));
}
world.observer.setGlobal('initial-number', 70);
world.observer.setGlobal('gain-from-food', 2);
world.observer.setGlobal('grass-regrowth-rate', 80);
world.observer.setGlobal('birthrate-%', 100);
      session.startLoop()
    </script>
  

</body></html>